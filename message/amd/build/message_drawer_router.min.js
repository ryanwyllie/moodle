define(["jquery","core/pubsub","core_message/message_drawer_events"],function(a,b,c){var d={},e=[],f=function(a,b,c){d[a]={elements:b,onGo:c}},g=function(a){var e,f=[].slice.call(arguments,1);Object.keys(d).forEach(function(b){var c=d[b],f=b===a;f&&(e=c),c.elements.forEach(function(a){a.removeClass("previous"),f?a.removeClass("hidden"):a.addClass("hidden")})}),e&&e.onGo&&e.onGo.apply(void 0,e.elements.concat(f));var g={route:a,params:f};return b.publish(c.ROUTE_CHANGED,g),g},h=function(){var a=g.apply(null,arguments),b=!1;e=e.reduce(function(c,d){return d.route===a.route&&(b=!0),b||c.push(d),c},[]);var c=e.length?e[e.length-1]:null;return c&&d[c.route].elements.forEach(function(a){a.addClass("previous")}),e.push(a),a},i=function(){if(e.length){e.pop();var a=e.pop();a&&h.apply(void 0,[a.route].concat(a.params))}};return{add:f,go:h,back:i}});