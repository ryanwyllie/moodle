define(["jquery","core/custom_interaction_events"],function(a,b){var c={LOADING_ICON_CONTAINER:'[data-region="loading-icon-container"]',CONTENT_CONTAINER:'[data-region="content-container"]',EMPTY_MESSAGE:'[data-region="empty-message-container"]',COLLAPSE_REGION:'[data-region="collapse-region"]',PLACEHOLDER:'[data-region="placeholder-container"]'},d=function(a){a.attr("data-loading",!0),a.find(c.LOADING_ICON_CONTAINER).removeClass("hidden")},e=function(a){a.attr("data-loading",!1),a.find(c.LOADING_ICON_CONTAINER).addClass("hidden")},f=function(a){return"true"===a.attr("data-loading")},g=function(a){return a.attr("data-user-id")},h=function(a){return a.find(c.CONTENT_CONTAINER)},i=function(a){return a.find(c.COLLAPSE_REGION)},j=function(a){return i(a).hasClass("show")},k=function(a){h(a).addClass("hidden"),a.find(c.EMPTY_MESSAGE).removeClass("hidden")},l=function(a){a.find(c.PLACEHOLDER).removeClass("hidden")},m=function(a){a.find(c.PLACEHOLDER).addClass("hidden")},n=function(a){h(a).removeClass("hidden")},o=function(a){h(a).addClass("hidden")},p=function(a){return"true"==a.attr("data-loaded-all")},q=function(a,b){a.attr("data-loaded-all",b)},r=function(a){return!p(a)&&!f(a)},s=function(a,b,c){return d(a),b(a,g(a)).then(function(b){if(b.length>0){var d=h(a);return c(d,b).then(function(){return b})}return b}).then(function(b){return e(a),a.attr("data-seen",!0),b.length||q(a,!0),b})["catch"](function(){e(a),a.attr("data-seen",!0)})},t=function(a,b,c){return h(a).empty(),l(a),o(a),s(a,b,c).then(function(b){m(a),n(a),b.length||k(a)})["catch"](function(){m(a),n(a)})},u=function(a,c,d){var e=i(a);b.define(e,[b.events.scrollBottom]),e.on(b.events.scrollBottom,function(){r(a)&&s(a,c,d)}),a.on("show.bs.collapse",function(){!a.attr("data-seen")&&r(a)&&t(a,c,d)})},v=function(b,c,d){b=a(b),b.attr("data-init")||(u(b,c,d),j(b)&&t(b,c,d),b.attr("data-init",!0))};return{show:v,getContentContainer:h,setLoadedAll:q}});