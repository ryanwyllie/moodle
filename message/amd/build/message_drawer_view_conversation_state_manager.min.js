define([],function(){var a=function(a){var b=Object.assign({},a);return b.messages=a.messages.map(function(a){return Object.assign({},a)}),b.members=Object.keys(a.members).reduce(function(b,c){return b[c]=Object.assign({},a.members[c]),b},{}),b},b=function(a,b,c){return a.map(function(a){var d=a.useridfrom==b;return{id:parseInt(a.id,10),isRead:a.isread,fromLoggedInUser:d,userFrom:c[a.useridfrom],text:a.text,timeCreated:parseInt(a.timecreated,10)}})},c=function(a,b,c,d){return{midnight:a,loggedInUserId:b,id:c,title:d,members:{},messages:[],hasTriedToLoadMessages:!1,loadingMessages:!0,sendingMessage:!1,loadingMembers:!0,loadingConfirmAction:!1,pendingBlockUserIds:[],pendingUnblockUserIds:[],pendingRemoveContactIds:[],pendingAddContactIds:[],pendingDeleteMessageIds:[],pendingDeleteConversation:!1,selectedMessageIds:[]}},d=function(c,d){var e=a(c),f=b(d,c.loggedInUserId,c.members),g=c.messages.concat(f);return g.sort(function(a,b){return a.timeCreated<b.timeCreated?-1:a.timeCreated>b.timeCreated?1:0}),e.messages=g.filter(function(a,b,c){return!b||a.id!==c[b-1].id}),e},e=function(b,c){var d=a(b),e=c.map(function(a){return a.id});return d.messages=d.messages.filter(function(a){return e.indexOf(a.id)<0}),d},f=function(b,c){var d=a(b);return d.messages=d.messages.filter(function(a){return c.indexOf(a.id)<0}),d},g=function(b,c){var d=a(b);return c.forEach(function(a){d.members[a.userid]=a}),d},h=function(b,c){var d=a(b);return c.forEach(function(a){delete d.members[a.userid]}),d},i=function(b,c){var d=a(b);return d.loadingMessages=c,b.loadingMessages&&!c&&(d.hasTriedToLoadMessages=!0),d},j=function(b,c){var d=a(b);return d.sendingMessage=c,d},k=function(b,c){var d=a(b);return d.loadingMembers=c,d},l=function(b,c){var d=a(b);return d.title=c,d},m=function(b,c){var d=a(b);return d.loadingConfirmAction=c,d},n=function(b,c){var d=a(b);return d.pendingDeleteConversation=c,d},o=function(b,c){var d=a(b);return c.forEach(function(a){d.pendingBlockUserIds.push(a)}),d},p=function(b,c){var d=a(b);return c.forEach(function(a){d.pendingRemoveContactIds.push(a)}),d},q=function(b,c){var d=a(b);return c.forEach(function(a){d.pendingUnblockUserIds.push(a)}),d},r=function(b,c){var d=a(b);return c.forEach(function(a){d.pendingAddContactIds.push(a)}),d},s=function(b,c){var d=a(b);return c.forEach(function(a){d.pendingDeleteMessageIds.push(a)}),d},t=function(b,c){var d=a(b);return d.pendingBlockUserIds=d.pendingBlockUserIds.filter(function(a){return c.indexOf(a)<0}),d},u=function(b,c){var d=a(b);return d.pendingRemoveContactIds=d.pendingRemoveContactIds.filter(function(a){return c.indexOf(a)<0}),d},v=function(b,c){var d=a(b);return d.pendingUnblockUserIds=d.pendingUnblockUserIds.filter(function(a){return c.indexOf(a)<0}),d},w=function(b,c){var d=a(b);return d.pendingAddContactIds=d.pendingAddContactIds.filter(function(a){return c.indexOf(a)<0}),d},x=function(b,c){var d=a(b);return d.pendingDeleteMessageIds=d.pendingDeleteMessageIds.filter(function(a){return c.indexOf(a)<0}),d},y=function(b,c){var d=a(b);return c.forEach(function(a){d.members.hasOwnProperty(a)&&(d.members[a].isblocked=!0)}),d},z=function(b,c){var d=a(b);return c.forEach(function(a){d.members.hasOwnProperty(a)&&(d.members[a].isblocked=!1)}),d},A=function(b,c){var d=a(b);return c.forEach(function(a){d.members.hasOwnProperty(a)&&(d.members[a].iscontact=!1)}),d},B=function(b,c){var d=a(b);return c.forEach(function(a){d.members.hasOwnProperty(a)&&(d.members[a].iscontact=!0)}),d},C=function(b,c){var d=a(b);return d.selectedMessageIds=d.selectedMessageIds.concat(c),d},D=function(b,c){var d=a(b);return d.selectedMessageIds=d.selectedMessageIds.filter(function(a){return c.indexOf(a)<0}),d},E=function(b,c){var d=a(b),e=c.map(function(a){return a.id});return d.messages=d.messages.map(function(a){return e.indexOf(a.id)>=0&&(a.isRead=!0),a}),d},F=function(b,c){var d=a(b);return d.members[c].sentcontactrequest=!0,d};return{buildInitialState:c,addMessages:d,removeMessages:e,removeMessagesById:f,addMembers:g,removeMembers:h,setLoadingMessages:i,setSendingMessage:j,setLoadingMembers:k,setTitle:l,setLoadingConfirmAction:m,setPendingDeleteConversation:n,addPendingBlockUsersById:o,addPendingRemoveContactsById:p,addPendingUnblockUsersById:q,addPendingAddContactsById:r,addPendingDeleteMessagesById:s,removePendingBlockUsersById:t,removePendingRemoveContactsById:u,removePendingUnblockUsersById:v,removePendingAddContactsById:w,removePendingDeleteMessagesById:x,blockUsersById:y,unblockUsersById:z,removeContactsById:A,addContactsById:B,addSelectedMessagesById:C,removeSelectedMessagesById:D,markMessagesAsRead:E,setContactRequestSent:F}});