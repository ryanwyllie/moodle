define(["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(a){"undefined"==typeof a.limit&&(a.limit=0),"undefined"==typeof a.offset&&(a.offset=0),a.limitfrom=a.offset,a.limitnum=a.limit,delete a.limit,delete a.offset;var d={methodname:"core_message_data_for_messagearea_conversations",args:a},e=b.call([d])[0];return e.fail(c.exception),e},e=function(a){var d={methodname:"core_message_get_unread_conversations_count",args:a},e=b.call([d])[0];return e.fail(c.exception),e},f=function(a){var d={methodname:"core_message_mark_all_messages_as_read",args:a},e=b.call([d])[0];return e.fail(c.exception),e},g=function(a,c,d){var e={userid:a};"undefined"!=typeof c&&(e.limitnum=c),"undefined"!=typeof d&&(e.limitfrom=d);var f={methodname:"core_message_data_for_messagearea_contacts",args:e};return b.call([f])[0]},h=function(a,c){var d={methodname:"core_message_data_for_messagearea_get_profile",args:{currentuserid:a,otheruserid:c}};return b.call([d])[0]},i=function(a,c){var d={methodname:"core_message_block_user",args:{userid:a,blockeduserid:c}};return b.call([d])[0]},j=function(a,c){var d={methodname:"core_message_unblock_user",args:{userid:a,unblockeduserid:c}};return b.call([d])[0]},k=function(a,c){var d={methodname:"core_message_create_contact_request",args:{userid:a,requesteduserid:c}};return b.call([d])[0]},l=function(a,c){var d={methodname:"core_message_delete_contacts",args:{userid:a,userids:c}};return b.call([d])[0]},m=function(a,c,d,e,f,g){var h={currentuserid:a,otheruserid:c,newest:!!f};"undefined"!=typeof d&&(h.limitnum=d),"undefined"!=typeof e&&(h.limitfrom=e),"undefined"!=typeof g&&(h.timefrom=g);var i={methodname:"core_message_data_for_messagearea_messages",args:h};return b.call([i])[0]},n=function(a,c,d,e){var f={userid:a,search:c};"undefined"!=typeof d&&("undefined"!=typeof e?f.limitnum=d+e:f.limitnum=d);var g={methodname:"core_message_data_for_messagearea_search_users",args:f};return b.call([g])[0].then(function(a){return e?{contacts:a.contacts.slice(e,e+d),noncontacts:a.noncontacts.slice(e,e+d),courses:a.courses.slice(e,e+d)}:a})},o=function(a,c,d,e){var f={userid:a,search:c};"undefined"!=typeof d&&(f.limitnum=d),"undefined"!=typeof e&&(f.limitfrom=e);var g={methodname:"core_message_data_for_messagearea_search_messages",args:f};return b.call([g])[0]},p=function(a){var c={methodname:"core_message_send_instant_messages",args:{messages:a}};return b.call([c])[0]},q=function(a,b){var c={touserid:a,text:b};return p([c]).then(function(a){return a[0]})},r=function(a,c){var d={methodname:"core_user_update_user_preferences",args:{userid:a,preferences:c}};return b.call([d])[0]},s=function(a){var c={methodname:"core_user_get_user_preferences",args:{userid:a}};return b.call([c])[0]},t=function(a,c){return b.call(c.map(function(b){return{methodname:"core_message_delete_message",args:{messageid:b,userid:a}}}))},u=function(a,c){var d={methodname:"core_message_delete_conversation",args:{userid:a,otheruserid:c}};return b.call([d])[0]};return{query:d,countUnreadConversations:e,markAllAsRead:f,getContacts:g,getProfile:h,blockUser:i,unblockUser:j,createContactRequest:k,deleteContacts:l,getMessages:m,searchUsers:n,searchMessages:o,sendMessages:p,sendMessage:q,savePreferences:r,getPreferences:s,deleteMessages:t,deleteCoversation:u}});