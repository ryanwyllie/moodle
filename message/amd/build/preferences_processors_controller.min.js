define(["jquery","core/ajax","core/notification"],function(a,b,c){var d={PROCESSOR:"[data-processor-name]"},e=function(b,c){this.root=a(b),this.userId=c,this.name=this.root.attr("data-processor-name")};e.prototype.startLoading=function(){this.root.addClass("loading")},e.prototype.stopLoading=function(){this.root.removeClass("loading")},e.prototype.isLoading=function(){return this.root.hasClass("loading")},e.prototype.save=function(){if(this.isLoading())return a.Deferred();this.startLoading();var d=this.root.find("form").serializeArray(),e={methodname:"core_message_message_processor_config_form",args:{userid:this.userId,name:this.name,formvalues:d}};return b.call([e])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))};var f=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.root.on("change",function(b){var c=a(b.target).closest(d.PROCESSOR),f=new e(c,this.userId);f.save()}.bind(this))};return f});