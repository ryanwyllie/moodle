'use strict';define('tool_dataprivacy/data_deletion',['jquery','core/ajax','core/notification','core/str','core/modal_factory','core/modal_events'],function($,Ajax,Notification,Str,ModalFactory,ModalEvents){function showConfirmation(ids){var modalTitle='';Str.get_strings([{key:'confirm',component:'moodle'},{key:'confirmcontextdeletion',component:'tool_dataprivacy'}]).then(function(langStrings){modalTitle=langStrings[0];var confirmMessage=langStrings[1];return ModalFactory.create({title:modalTitle,body:confirmMessage,type:ModalFactory.types.SAVE_CANCEL})}).then(function(modal){return modal.setSaveButtonText(modalTitle),modal.getRoot().on(ModalEvents.save,function(){Ajax.call([{methodname:'tool_dataprivacy_confirm_contexts_for_deletion',args:{ids:ids}}])[0].done(function(data){data.result?window.location.reload():Notification.addNotification({message:data.warnings[0].message,type:'error'})}).fail(Notification.exception)}),modal.getRoot().on(ModalEvents.hidden,function(){modal.destroy()}),modal}).done(function(modal){modal.show()}).fail(Notification.exception)}var ACTIONS={MARK_FOR_DELETION:'[data-action="markfordeletion"]',SELECT_ALL:'[data-action="selectall"]'},SELECTORS={SELECTCONTEXT:'.selectcontext'},DataDeletionActions=function(){this.registerEvents()};return DataDeletionActions.prototype.registerEvents=function(){$(ACTIONS.MARK_FOR_DELETION).click(function(e){e.preventDefault();var selectedIds=[];$(SELECTORS.SELECTCONTEXT).each(function(){var checkbox=$(this);checkbox.is(':checked')&&selectedIds.push(checkbox.val())}),showConfirmation(selectedIds)}),$(ACTIONS.SELECT_ALL).change(function(e){e.preventDefault();var selectallnone=$(this);selectallnone.is(':checked')?$(SELECTORS.SELECTCONTEXT).attr('checked','checked'):$(SELECTORS.SELECTCONTEXT).removeAttr('checked')})},DataDeletionActions});
//# sourceMappingURL=data_deletion.min.js.map
