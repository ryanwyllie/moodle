'use strict';define('tool_policy/policyactions',['jquery','core/ajax','core/notification','core/modal_factory','core/modal_events'],function($,Ajax,Notification,ModalFactory,ModalEvents){var ACTIONS={VIEW_POLICY:'[data-action="view"]'},PolicyActions=function(){this.registerEvents()};return PolicyActions.prototype.registerEvents=function(){$(ACTIONS.VIEW_POLICY).click(function(e){e.preventDefault();var versionid=$(this).data('versionid'),behalfid=$(this).data('behalfid'),promises=Ajax.call([{methodname:'tool_policy_get_policy_version',args:{versionid:versionid,behalfid:behalfid}}]),modalTitle='',modalType=ModalFactory.types.DEFAULT;$.when(promises[0]).then(function(data){return data.result.policy?(modalTitle=data.result.policy.name,data.result.policy.content):(Notification.addNotification({message:data.warnings[0].message,type:'error'}),!1)}).then(function(html){return!1!=html&&ModalFactory.create({title:modalTitle,body:html,type:modalType,large:!0}).then(function(modal){return modal.getRoot().on(ModalEvents.hidden,function(){modal.destroy()}),modal})}).done(function(modal){modal.show()}).fail(Notification.exception)})},{init:function init(){return new PolicyActions}}});
//# sourceMappingURL=policyactions.min.js.map
