{"version":3,"sources":["../src/tour.js"],"names":["root","factory","define","amd","a0","b1","module","exports","require","$","Popper","Math","ceil","_typeof","Symbol","iterator","obj","constructor","prototype","Tour","config","init","tourName","storageKey","storage","originalConfiguration","listeners","eventHandlers","steps","currentStepNode","currentStepNumber","currentStepPopper","currentStepConfig","templateContent","reset","configure","apply","arguments","window","sessionStorage","e","hide","resetStepListeners","_this","eventName","forEach","handler","addEventHandler","resetStepDefaults","template","checkMinimumRequirements","Error","length","loadOriginalConfiguration","stepDefaults","setStepDefaults","extend","element","placement","delay","moveOnClick","moveAfterTime","orphan","direction","getCurrentStepNumber","parseInt","setCurrentStepNumber","stepNumber","setItem","code","DOMException","QUOTA_EXCEEDED_ERR","removeItem","getNextStepNumber","nextStepNumber","isStepPotentiallyVisible","getStepConfig","getPreviousStepNumber","previousStepNumber","isLastStep","isFirstStep","stepConfig","isStepActuallyVisible","target","getStepTarget","is","next","gotoStep","previous","endTour","_gotoStep","delayed","setTimeout","bind","fn","fireEventHandlers","renderStep","normalizeStepConfig","reflex","moveAfterClick","content","body","attachTo","attachPoint","first","data","thisEvent","call","push","processStepListeners","node","args","proxy","handleKeyDown","targetNode","parents","listener","on","off","getTemplateContent","find","html","title","prop","attr","addStepToPage","clone","stepContent","animationTarget","stop","zIndex","calculateZIndex","css","positionBackdrop","document","append","top","left","animate","scrollTop","calculateScrollTop","promise","then","positionStep","revealStep","isOrphan","addClass","offset","calculateStepPositionInPage","removeOnDestroy","arrowElement","modifiers","enabled","applyStyle","onLoad","fadeIn","announceStep","focus","stepId","bodyRegion","headerRegion","accessibilityShow","keyCode","hasBackdrop","activeElement","stepTarget","tabbableNodes","dialogContainer","currentIndex","filter","index","has","each","nextIndex","nextNode","focusRelevant","shiftKey","closest","last","preventDefault","startTour","startAt","storageStartValue","getItem","storageStartAt","restartTour","previousTarget","transition","destroy","fadeTime","remove","removeAttr","fadeOut","currentStepElement","accessibilityHide","show","getStepContainer","viewportHeight","height","max","min","stepHeight","viewportWidth","width","stepWidth","flipBehavior","flip","behaviour","arrow","onCreate","recalculateArrowPosition","onUpdate","split","isVertical","indexOf","instance","popper","querySelector","stepElement","arrowHeight","parseFloat","getComputedStyle","arrowOffset","popperHeight","popperOffset","popperBorderWidth","popperBorderRadiusWidth","arrowPos","maxPos","minPos","newArrowPos","arrowWidth","_arrowOffset","popperWidth","_popperOffset","_popperBorderWidth","_popperBorderRadiusWidth","_arrowPos","_maxPos","_minPos","_newArrowPos","background","backdrop","insertAfter","buffer","colorNode","outerWidth","outerHeight","backgroundColor","calculateInherittedBackgroundColor","targetRadius","targetPosition","calculatePosition","fader","opacity","elem","position","value","isNaN","parent","fakeNode","fakeElemColor","color","attrName","hideFunction","child","flexitourRole","hidden","siblings","parentsUntil","showFunction"],"mappings":"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","sourcesContent":["// jshint ignore: start\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"jquery\",\"core/popper\"], function (a0,b1) {\n      return (root['Tour'] = factory(a0,b1));\n    });\n  } else if (typeof module === 'object' && module.exports) {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"jquery\"),require(\"popper.js\"));\n  } else {\n    root['Tour'] = factory(root[\"$\"],root[\"Popper\"]);\n  }\n}(this, function ($, Popper) {\n\n\"use strict\";\n\n/**\n * A Tour.\n *\n * @class   Tour\n * @param   {object}    config  The configuration object.\n */\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction Tour(config) {\n    this.init(config);\n}\n\n/**\n * The name of the tour.\n *\n * @property    {String}    tourName\n */\nTour.prototype.tourName;\n\n/**\n * The name of the tour storage key.\n *\n * @property    {String}    storageKey\n */\nTour.prototype.storageKey;\n\n/**\n * The session storage object\n *\n * @property    {Storage}   storage\n */\nTour.prototype.storage;\n\n/**\n * The original configuration as passed into the constructor.\n *\n * @property    {Object}    originalConfiguration\n */\nTour.prototype.originalConfiguration;\n\n/**\n * The list of step listeners.\n *\n * @property    {Array}     listeners\n */\nTour.prototype.listeners;\n\n/**\n * The list of event handlers.\n *\n * @property    {Object}    eventHandlers\n */\nTour.prototype.eventHandlers;\n\n/**\n * The list of steps.\n *\n * @property    {Object[]}      steps\n */\nTour.prototype.steps;\n\n/**\n * The current step node.\n *\n * @property    {jQuery}        currentStepNode\n */\nTour.prototype.currentStepNode;\n\n/**\n * The current step number.\n *\n * @property    {Number}        currentStepNumber\n */\nTour.prototype.currentStepNumber;\n\n/**\n * The popper for the current step.\n *\n * @property    {Popper}        currentStepPopper\n */\nTour.prototype.currentStepPopper;\n\n/**\n * The config for the current step.\n *\n * @property    {Object}        currentStepConfig\n */\nTour.prototype.currentStepConfig;\n\n/**\n * The template content.\n *\n * @property    {String}        templateContent\n */\nTour.prototype.templateContent;\n\n/**\n * Initialise the tour.\n *\n * @method  init\n * @param   {Object}    config  The configuration object.\n * @chainable\n */\nTour.prototype.init = function (config) {\n    // Unset all handlers.\n    this.eventHandlers = {};\n\n    // Reset the current tour states.\n    this.reset();\n\n    // Store the initial configuration.\n    this.originalConfiguration = config || {};\n\n    // Apply configuration.\n    this.configure.apply(this, arguments);\n\n    try {\n        this.storage = window.sessionStorage;\n        this.storageKey = 'tourstate_' + this.tourName;\n    } catch (e) {\n        this.storage = false;\n        this.storageKey = '';\n    }\n\n    return this;\n};\n\n/**\n * Reset the current tour state.\n *\n * @method  reset\n * @chainable\n */\nTour.prototype.reset = function () {\n    // Hide the current step.\n    this.hide();\n\n    // Unset all handlers.\n    this.eventHandlers = [];\n\n    // Unset all listeners.\n    this.resetStepListeners();\n\n    // Unset the original configuration.\n    this.originalConfiguration = {};\n\n    // Reset the current step number and list of steps.\n    this.steps = [];\n\n    // Reset the current step number.\n    this.currentStepNumber = 0;\n\n    return this;\n};\n\n/**\n * Prepare tour configuration.\n *\n * @method  configure\n * @chainable\n */\nTour.prototype.configure = function (config) {\n    var _this = this;\n\n    if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n        // Tour name.\n        if (typeof config.tourName !== 'undefined') {\n            this.tourName = config.tourName;\n        }\n\n        // Set up eventHandlers.\n        if (config.eventHandlers) {\n            (function () {\n                var eventName = void 0;\n                for (eventName in config.eventHandlers) {\n                    config.eventHandlers[eventName].forEach(function (handler) {\n                        this.addEventHandler(eventName, handler);\n                    }, _this);\n                }\n            })();\n        }\n\n        // Reset the step configuration.\n        this.resetStepDefaults(true);\n\n        // Configure the steps.\n        if (_typeof(config.steps) === 'object') {\n            this.steps = config.steps;\n        }\n\n        if (typeof config.template !== 'undefined') {\n            this.templateContent = config.template;\n        }\n    }\n\n    // Check that we have enough to start the tour.\n    this.checkMinimumRequirements();\n\n    return this;\n};\n\n/**\n * Check that the configuration meets the minimum requirements.\n *\n * @method  checkMinimumRequirements\n * @chainable\n */\nTour.prototype.checkMinimumRequirements = function () {\n    // Need a tourName.\n    if (!this.tourName) {\n        throw new Error(\"Tour Name required\");\n    }\n\n    // Need a minimum of one step.\n    if (!this.steps || !this.steps.length) {\n        throw new Error(\"Steps must be specified\");\n    }\n};\n\n/**\n * Reset step default configuration.\n *\n * @method  resetStepDefaults\n * @param   {Boolean}   loadOriginalConfiguration   Whether to load the original configuration supplied with the Tour.\n * @chainable\n */\nTour.prototype.resetStepDefaults = function (loadOriginalConfiguration) {\n    if (typeof loadOriginalConfiguration === 'undefined') {\n        loadOriginalConfiguration = true;\n    }\n\n    this.stepDefaults = {};\n    if (!loadOriginalConfiguration || typeof this.originalConfiguration.stepDefaults === 'undefined') {\n        this.setStepDefaults({});\n    } else {\n        this.setStepDefaults(this.originalConfiguration.stepDefaults);\n    }\n\n    return this;\n};\n\n/**\n * Set the step defaults.\n *\n * @method  setStepDefaults\n * @param   {Object}    stepDefaults                The step defaults to apply to all steps\n * @chainable\n */\nTour.prototype.setStepDefaults = function (stepDefaults) {\n    if (!this.stepDefaults) {\n        this.stepDefaults = {};\n    }\n    $.extend(this.stepDefaults, {\n        element: '',\n        placement: 'top',\n        delay: 0,\n        moveOnClick: false,\n        moveAfterTime: 0,\n        orphan: false,\n        direction: 1\n    }, stepDefaults);\n\n    return this;\n};\n\n/**\n * Retrieve the current step number.\n *\n * @method  getCurrentStepNumber\n * @return  {Integer}                   The current step number\n */\nTour.prototype.getCurrentStepNumber = function () {\n    return parseInt(this.currentStepNumber, 10);\n};\n\n/**\n * Store the current step number.\n *\n * @method  setCurrentStepNumber\n * @param   {Integer}   stepNumber      The current step number\n * @chainable\n */\nTour.prototype.setCurrentStepNumber = function (stepNumber) {\n    this.currentStepNumber = stepNumber;\n    if (this.storage) {\n        try {\n            this.storage.setItem(this.storageKey, stepNumber);\n        } catch (e) {\n            if (e.code === DOMException.QUOTA_EXCEEDED_ERR) {\n                this.storage.removeItem(this.storageKey);\n            }\n        }\n    }\n};\n\n/**\n * Get the next step number after the currently displayed step.\n *\n * @method  getNextStepNumber\n * @return  {Integer}    The next step number to display\n */\nTour.prototype.getNextStepNumber = function (stepNumber) {\n    if (typeof stepNumber === 'undefined') {\n        stepNumber = this.getCurrentStepNumber();\n    }\n    var nextStepNumber = stepNumber + 1;\n\n    // Keep checking the remaining steps.\n    while (nextStepNumber <= this.steps.length) {\n        if (this.isStepPotentiallyVisible(this.getStepConfig(nextStepNumber))) {\n            return nextStepNumber;\n        }\n        nextStepNumber++;\n    }\n\n    return null;\n};\n\n/**\n * Get the previous step number before the currently displayed step.\n *\n * @method  getPreviousStepNumber\n * @return  {Integer}    The previous step number to display\n */\nTour.prototype.getPreviousStepNumber = function (stepNumber) {\n    if (typeof stepNumber === 'undefined') {\n        stepNumber = this.getCurrentStepNumber();\n    }\n    var previousStepNumber = stepNumber - 1;\n\n    // Keep checking the remaining steps.\n    while (previousStepNumber >= 0) {\n        if (this.isStepPotentiallyVisible(this.getStepConfig(previousStepNumber))) {\n            return previousStepNumber;\n        }\n        previousStepNumber--;\n    }\n\n    return null;\n};\n\n/**\n * Is the step the final step number?\n *\n * @method  isLastStep\n * @param   {Integer}   stepNumber  Step number to test\n * @return  {Boolean}               Whether the step is the final step\n */\nTour.prototype.isLastStep = function (stepNumber) {\n    var nextStepNumber = this.getNextStepNumber(stepNumber);\n\n    return nextStepNumber === null;\n};\n\n/**\n * Is the step the first step number?\n *\n * @method  isFirstStep\n * @param   {Integer}   stepNumber  Step number to test\n * @return  {Boolean}               Whether the step is the first step\n */\nTour.prototype.isFirstStep = function (stepNumber) {\n    var previousStepNumber = this.getPreviousStepNumber(stepNumber);\n\n    return previousStepNumber === null;\n};\n\n/**\n * Is this step potentially visible?\n *\n * @method  isStepPotentiallyVisible\n * @param   {Integer}   stepNumber  Step number to test\n * @return  {Boolean}               Whether the step is the potentially visible\n */\nTour.prototype.isStepPotentiallyVisible = function (stepConfig) {\n    if (!stepConfig) {\n        // Without step config, there can be no step.\n        return false;\n    }\n\n    if (this.isStepActuallyVisible(stepConfig)) {\n        // If it is actually visible, it is already potentially visible.\n        return true;\n    }\n\n    if (typeof stepConfig.orphan !== 'undefined' && stepConfig.orphan) {\n        // Orphan steps have no target. They are always visible.\n        return true;\n    }\n\n    if (typeof stepConfig.delay !== 'undefined' && stepConfig.delay) {\n        // Only return true if the activated has not been used yet.\n        return true;\n    }\n\n    // Not theoretically, or actually visible.\n    return false;\n};\n\n/**\n * Is this step actually visible?\n *\n * @method  isStepActuallyVisible\n * @param   {Integer}   stepNumber  Step number to test\n * @return  {Boolean}               Whether the step is actually visible\n */\nTour.prototype.isStepActuallyVisible = function (stepConfig) {\n    if (!stepConfig) {\n        // Without step config, there can be no step.\n        return false;\n    }\n\n    var target = this.getStepTarget(stepConfig);\n    if (target && target.length && target.is(':visible')) {\n        // Without a target, there can be no step.\n        return !!target.length;\n    }\n\n    return false;\n};\n\n/**\n * Go to the next step in the tour.\n *\n * @method  next\n * @chainable\n */\nTour.prototype.next = function () {\n    return this.gotoStep(this.getNextStepNumber());\n};\n\n/**\n * Go to the previous step in the tour.\n *\n * @method  previous\n * @chainable\n */\nTour.prototype.previous = function () {\n    return this.gotoStep(this.getPreviousStepNumber(), -1);\n};\n\n/**\n * Go to the specified step in the tour.\n *\n * @method  gotoStep\n * @param   {Integer}   stepNumber      The step number to display\n * @chainable\n */\nTour.prototype.gotoStep = function (stepNumber, direction) {\n    if (stepNumber < 0) {\n        return this.endTour();\n    }\n\n    var stepConfig = this.getStepConfig(stepNumber);\n    if (stepConfig === null) {\n        return this.endTour();\n    }\n\n    return this._gotoStep(stepConfig, direction);\n};\n\nTour.prototype._gotoStep = function (stepConfig, direction) {\n    if (!stepConfig) {\n        return this.endTour();\n    }\n\n    if (typeof stepConfig.delay !== 'undefined' && stepConfig.delay && !stepConfig.delayed) {\n        stepConfig.delayed = true;\n        window.setTimeout(this._gotoStep.bind(this), stepConfig.delay, stepConfig, direction);\n\n        return this;\n    } else if (!stepConfig.orphan && !this.isStepActuallyVisible(stepConfig)) {\n        var fn = direction == -1 ? 'getPreviousStepNumber' : 'getNextStepNumber';\n        return this.gotoStep(this[fn](stepConfig.stepNumber), direction);\n    }\n\n    this.hide();\n\n    this.fireEventHandlers('beforeRender', stepConfig);\n    this.renderStep(stepConfig);\n    this.fireEventHandlers('afterRender', stepConfig);\n\n    return this;\n};\n\n/**\n * Fetch the normalised step configuration for the specified step number.\n *\n * @method  getStepConfig\n * @param   {Integer}   stepNumber      The step number to fetch configuration for\n * @return  {Object}                    The step configuration\n */\nTour.prototype.getStepConfig = function (stepNumber) {\n    if (stepNumber === null || stepNumber < 0 || stepNumber >= this.steps.length) {\n        return null;\n    }\n\n    // Normalise the step configuration.\n    var stepConfig = this.normalizeStepConfig(this.steps[stepNumber]);\n\n    // Add the stepNumber to the stepConfig.\n    stepConfig = $.extend(stepConfig, { stepNumber: stepNumber });\n\n    return stepConfig;\n};\n\n/**\n * Normalise the supplied step configuration.\n *\n * @method  normalizeStepConfig\n * @param   {Object}    stepConfig      The step configuration to normalise\n * @return  {Object}                    The normalised step configuration\n */\nTour.prototype.normalizeStepConfig = function (stepConfig) {\n\n    if (typeof stepConfig.reflex !== 'undefined' && typeof stepConfig.moveAfterClick === 'undefined') {\n        stepConfig.moveAfterClick = stepConfig.reflex;\n    }\n\n    if (typeof stepConfig.element !== 'undefined' && typeof stepConfig.target === 'undefined') {\n        stepConfig.target = stepConfig.element;\n    }\n\n    if (typeof stepConfig.content !== 'undefined' && typeof stepConfig.body === 'undefined') {\n        stepConfig.body = stepConfig.content;\n    }\n\n    stepConfig = $.extend({}, this.stepDefaults, stepConfig);\n\n    stepConfig = $.extend({}, {\n        attachTo: stepConfig.target,\n        attachPoint: 'after'\n    }, stepConfig);\n\n    if (stepConfig.attachTo) {\n        stepConfig.attachTo = $(stepConfig.attachTo).first();\n    }\n\n    return stepConfig;\n};\n\n/**\n * Fetch the actual step target from the selector.\n *\n * This should not be called until after any delay has completed.\n *\n * @method  getStepTarget\n * @param   {Object}    stepConfig      The step configuration\n * @return  {$}\n */\nTour.prototype.getStepTarget = function (stepConfig) {\n    if (stepConfig.target) {\n        return $(stepConfig.target);\n    }\n\n    return null;\n};\n\n/**\n * Fire any event handlers for the specified event.\n *\n * @param   {String}    eventName       The name of the event to handle\n * @param   {Object}    data            Any data to pass to the event\n * @chainable\n */\nTour.prototype.fireEventHandlers = function (eventName, data) {\n    if (typeof this.eventHandlers[eventName] === 'undefined') {\n        return this;\n    }\n\n    this.eventHandlers[eventName].forEach(function (thisEvent) {\n        thisEvent.call(this, data);\n    }, this);\n\n    return this;\n};\n\n/**\n * @method  addEventHandler\n * @param   string      eventName       The name of the event to listen for\n * @param   function    handler         The event handler to call\n */\nTour.prototype.addEventHandler = function (eventName, handler) {\n    if (typeof this.eventHandlers[eventName] === 'undefined') {\n        this.eventHandlers[eventName] = [];\n    }\n\n    this.eventHandlers[eventName].push(handler);\n\n    return this;\n};\n\n/**\n * Process listeners for the step being shown.\n *\n * @method  processStepListeners\n * @param   {object}    stepConfig      The configuration for the step\n * @chainable\n */\nTour.prototype.processStepListeners = function (stepConfig) {\n    this.listeners.push(\n    // Next/Previous buttons.\n    {\n        node: this.currentStepNode,\n        args: ['click', '[data-role=\"next\"]', $.proxy(this.next, this)]\n    }, {\n        node: this.currentStepNode,\n        args: ['click', '[data-role=\"previous\"]', $.proxy(this.previous, this)]\n    },\n\n    // Close and end tour buttons.\n    {\n        node: this.currentStepNode,\n        args: ['click', '[data-role=\"end\"]', $.proxy(this.endTour, this)]\n    },\n\n    // Click backdrop and hide tour.\n    {\n        node: $('[data-flexitour=\"backdrop\"]'),\n        args: ['click', $.proxy(this.hide, this)]\n    },\n\n    // Keypresses.\n    {\n        node: $('body'),\n        args: ['keydown', $.proxy(this.handleKeyDown, this)]\n    });\n\n    if (stepConfig.moveOnClick) {\n        var targetNode = this.getStepTarget(stepConfig);\n        this.listeners.push({\n            node: targetNode,\n            args: ['click', $.proxy(function (e) {\n                if ($(e.target).parents('[data-flexitour=\"container\"]').length === 0) {\n                    // Ignore clicks when they are in the flexitour.\n                    window.setTimeout($.proxy(this.next, this), 500);\n                }\n            }, this)]\n        });\n    }\n\n    this.listeners.forEach(function (listener) {\n        listener.node.on.apply(listener.node, listener.args);\n    });\n\n    return this;\n};\n\n/**\n * Reset step listeners.\n *\n * @method  resetStepListeners\n * @chainable\n */\nTour.prototype.resetStepListeners = function () {\n    // Stop listening to all external handlers.\n    if (this.listeners) {\n        this.listeners.forEach(function (listener) {\n            listener.node.off.apply(listener.node, listener.args);\n        });\n    }\n    this.listeners = [];\n\n    return this;\n};\n\n/**\n * The standard step renderer.\n *\n * @method  renderStep\n * @param   {Object}    stepConfig      The step configuration of the step\n * @chainable\n */\nTour.prototype.renderStep = function (stepConfig) {\n    // Store the current step configuration for later.\n    this.currentStepConfig = stepConfig;\n    this.setCurrentStepNumber(stepConfig.stepNumber);\n\n    // Fetch the template and convert it to a $ object.\n    var template = $(this.getTemplateContent());\n\n    // Title.\n    template.find('[data-placeholder=\"title\"]').html(stepConfig.title);\n\n    // Body.\n    template.find('[data-placeholder=\"body\"]').html(stepConfig.body);\n\n    // Is this the first step?\n    if (this.isFirstStep(stepConfig.stepNumber)) {\n        template.find('[data-role=\"previous\"]').prop('disabled', true);\n    } else {\n        template.find('[data-role=\"previous\"]').prop('disabled', false);\n    }\n\n    // Is this the final step?\n    if (this.isLastStep(stepConfig.stepNumber)) {\n        template.find('[data-role=\"next\"]').prop('disabled', true);\n    } else {\n        template.find('[data-role=\"next\"]').prop('disabled', false);\n    }\n\n    template.find('[data-role=\"previous\"]').attr('role', 'button');\n    template.find('[data-role=\"next\"]').attr('role', 'button');\n    template.find('[data-role=\"end\"]').attr('role', 'button');\n\n    // Replace the template with the updated version.\n    stepConfig.template = template;\n\n    // Add to the page.\n    this.addStepToPage(stepConfig);\n\n    // Process step listeners after adding to the page.\n    // This uses the currentNode.\n    this.processStepListeners(stepConfig);\n\n    return this;\n};\n\n/**\n * Getter for the template content.\n *\n * @method  getTemplateContent\n * @return  {$}\n */\nTour.prototype.getTemplateContent = function () {\n    return $(this.templateContent).clone();\n};\n\n/**\n * Helper to add a step to the page.\n *\n * @method  addStepToPage\n * @param   {Object}    stepConfig      The step configuration of the step\n * @chainable\n */\nTour.prototype.addStepToPage = function (stepConfig) {\n    var stepContent = stepConfig.template;\n\n    // Create the stepNode from the template data.\n    var currentStepNode = $('<span data-flexitour=\"container\"></span>').html(stepConfig.template).hide();\n\n    // The scroll animation occurs on the body or html.\n    var animationTarget = $('body, html').stop(true, true);\n\n    if (this.isStepActuallyVisible(stepConfig)) {\n        var targetNode = this.getStepTarget(stepConfig);\n\n        targetNode.data('flexitour', 'target');\n\n        var zIndex = this.calculateZIndex(targetNode);\n        if (zIndex) {\n            stepConfig.zIndex = zIndex + 1;\n        }\n\n        if (stepConfig.zIndex) {\n            currentStepNode.css('zIndex', stepConfig.zIndex + 1);\n        }\n\n        // Add the backdrop.\n        this.positionBackdrop(stepConfig);\n\n        $(document.body).append(currentStepNode);\n        this.currentStepNode = currentStepNode;\n\n        // Ensure that the step node is positioned.\n        // Some situations mean that the value is not properly calculated without this step.\n        this.currentStepNode.css({\n            top: 0,\n            left: 0\n        });\n\n        animationTarget.animate({\n            scrollTop: this.calculateScrollTop(stepConfig)\n        }).promise().then(function () {\n            this.positionStep(stepConfig);\n            this.revealStep(stepConfig);\n        }.bind(this));\n    } else if (stepConfig.orphan) {\n        stepConfig.isOrphan = true;\n\n        // This will be appended to the body instead.\n        stepConfig.attachTo = $('body').first();\n        stepConfig.attachPoint = 'append';\n\n        // Add the backdrop.\n        this.positionBackdrop(stepConfig);\n\n        // This is an orphaned step.\n        currentStepNode.addClass('orphan');\n\n        // It lives in the body.\n        $(document.body).append(currentStepNode);\n        this.currentStepNode = currentStepNode;\n\n        this.currentStepNode.offset(this.calculateStepPositionInPage());\n        this.currentStepNode.css('position', 'fixed');\n\n        this.currentStepPopper = new Popper($('body'), this.currentStepNode[0], {\n            removeOnDestroy: true,\n            placement: stepConfig.placement + '-start',\n            arrowElement: '[data-role=\"arrow\"]',\n            // Empty the modifiers. We've already placed the step and don't want it moved.\n            modifiers: {\n                hide: {\n                    enabled: false\n                },\n                applyStyle: {\n                    onLoad: null,\n                    enabled: false\n                }\n            }\n        });\n\n        this.revealStep(stepConfig);\n    }\n\n    return this;\n};\n\nTour.prototype.revealStep = function (stepConfig) {\n    // Fade the step in.\n    this.currentStepNode.fadeIn('', $.proxy(function () {\n        // Announce via ARIA.\n        this.announceStep(stepConfig);\n\n        // Focus on the current step Node.\n        this.currentStepNode.focus();\n        window.setTimeout($.proxy(function () {\n            // After a brief delay, focus again.\n            // There seems to be an issue with Jaws where it only reads the dialogue title initially.\n            // This second focus helps it to read the full dialogue.\n            if (this.currentStepNode) {\n                this.currentStepNode.focus();\n            }\n        }, this), 100);\n    }, this));\n\n    return this;\n};\n\n/**\n * Helper to announce the step on the page.\n *\n * @method  announceStep\n * @param   {Object}    stepConfig      The step configuration of the step\n * @chainable\n */\nTour.prototype.announceStep = function (stepConfig) {\n    // Setup the step Dialogue as per:\n    // * https://www.w3.org/TR/wai-aria-practices/#dialog_nonmodal\n    // * https://www.w3.org/TR/wai-aria-practices/#dialog_modal\n\n    // Generate an ID for the current step node.\n    var stepId = 'tour-step-' + this.tourName + '-' + stepConfig.stepNumber;\n    this.currentStepNode.attr('id', stepId);\n\n    var bodyRegion = this.currentStepNode.find('[data-placeholder=\"body\"]').first();\n    bodyRegion.attr('id', stepId + '-body');\n    bodyRegion.attr('role', 'document');\n\n    var headerRegion = this.currentStepNode.find('[data-placeholder=\"title\"]').first();\n    headerRegion.attr('id', stepId + '-title');\n    headerRegion.attr('aria-labelledby', stepId + '-body');\n\n    // Generally, a modal dialog has a role of dialog.\n    this.currentStepNode.attr('role', 'dialog');\n    this.currentStepNode.attr('tabindex', 0);\n    this.currentStepNode.attr('aria-labelledby', stepId + '-title');\n    this.currentStepNode.attr('aria-describedby', stepId + '-body');\n\n    // Configure ARIA attributes on the target.\n    var target = this.getStepTarget(stepConfig);\n    if (target) {\n        if (!target.attr('tabindex')) {\n            target.attr('tabindex', 0);\n        }\n\n        target.data('original-describedby', target.attr('aria-describedby')).attr('aria-describedby', stepId + '-body');\n    }\n\n    this.accessibilityShow(stepConfig);\n\n    return this;\n};\n\n/**\n * Handle key down events.\n *\n * @method  handleKeyDown\n * @param   {EventFacade} e\n */\nTour.prototype.handleKeyDown = function (e) {\n    var tabbableSelector = 'a[href], link[href], [draggable=true], [contenteditable=true], :input:enabled, [tabindex], button:enabled';\n    switch (e.keyCode) {\n        case 27:\n            this.endTour();\n            break;\n\n        // 9 == Tab - trap focus for items with a backdrop.\n        case 9:\n            // Tab must be handled on key up only in this instance.\n            (function () {\n                if (!this.currentStepConfig.hasBackdrop) {\n                    // Trapping tab focus is only handled for those steps with a backdrop.\n                    return;\n                }\n\n                // Find all tabbable locations.\n                var activeElement = $(document.activeElement);\n                var stepTarget = this.getStepTarget(this.currentStepConfig);\n                var tabbableNodes = $(tabbableSelector);\n                var dialogContainer = $('span[data-flexitour=\"container\"]');\n                var currentIndex = void 0;\n                // Filter out element which is not belong to target section or dialogue.\n                if (stepTarget) {\n                    tabbableNodes = tabbableNodes.filter(function (index, element) {\n                        return stepTarget != null && (stepTarget.has(element).length || dialogContainer.has(element).length || stepTarget.is(element) || dialogContainer.is(element));\n                    });\n                }\n\n                // Find index of focusing element.\n                tabbableNodes.each(function (index, element) {\n                    if (activeElement.is(element)) {\n                        currentIndex = index;\n                        return false;\n                    }\n                });\n\n                var nextIndex = void 0;\n                var nextNode = void 0;\n                var focusRelevant = void 0;\n                if (currentIndex != void 0) {\n                    var direction = 1;\n                    if (e.shiftKey) {\n                        direction = -1;\n                    }\n                    nextIndex = currentIndex;\n                    do {\n                        nextIndex += direction;\n                        nextNode = $(tabbableNodes[nextIndex]);\n                    } while (nextNode.length && nextNode.is(':disabled') || nextNode.is(':hidden'));\n                    if (nextNode.length) {\n                        // A new f\n                        focusRelevant = nextNode.closest(stepTarget).length;\n                        focusRelevant = focusRelevant || nextNode.closest(this.currentStepNode).length;\n                    } else {\n                        // Unable to find the target somehow.\n                        focusRelevant = false;\n                    }\n                }\n\n                if (focusRelevant) {\n                    nextNode.focus();\n                } else {\n                    if (e.shiftKey) {\n                        // Focus on the last tabbable node in the step.\n                        this.currentStepNode.find(tabbableSelector).last().focus();\n                    } else {\n                        if (this.currentStepConfig.isOrphan) {\n                            // Focus on the step - there is no target.\n                            this.currentStepNode.focus();\n                        } else {\n                            // Focus on the step target.\n                            stepTarget.focus();\n                        }\n                    }\n                }\n                e.preventDefault();\n            }).call(this);\n            break;\n    }\n};\n\n/**\n * Start the current tour.\n *\n * @method  startTour\n * @param   {Integer}   startAt     Which step number to start at. If not specified, starts at the last point.\n * @chainable\n */\nTour.prototype.startTour = function (startAt) {\n    if (this.storage && typeof startAt === 'undefined') {\n        var storageStartValue = this.storage.getItem(this.storageKey);\n        if (storageStartValue) {\n            var storageStartAt = parseInt(storageStartValue, 10);\n            if (storageStartAt <= this.steps.length) {\n                startAt = storageStartAt;\n            }\n        }\n    }\n\n    if (typeof startAt === 'undefined') {\n        startAt = this.getCurrentStepNumber();\n    }\n\n    this.fireEventHandlers('beforeStart', startAt);\n    this.gotoStep(startAt);\n    this.fireEventHandlers('afterStart', startAt);\n\n    return this;\n};\n\n/**\n * Restart the tour from the beginning, resetting the completionlag.\n *\n * @method  restartTour\n * @chainable\n */\nTour.prototype.restartTour = function () {\n    return this.startTour(0);\n};\n\n/**\n * End the current tour.\n *\n * @method  endTour\n * @chainable\n */\nTour.prototype.endTour = function () {\n    this.fireEventHandlers('beforeEnd');\n\n    if (this.currentStepConfig) {\n        var previousTarget = this.getStepTarget(this.currentStepConfig);\n        if (previousTarget) {\n            if (!previousTarget.attr('tabindex')) {\n                previousTarget.attr('tabindex', '-1');\n            }\n            previousTarget.focus();\n        }\n    }\n\n    this.hide(true);\n\n    this.fireEventHandlers('afterEnd');\n\n    return this;\n};\n\n/**\n * Hide any currently visible steps.\n *\n * @method hide\n * @chainable\n */\nTour.prototype.hide = function (transition) {\n    this.fireEventHandlers('beforeHide');\n\n    if (this.currentStepNode && this.currentStepNode.length) {\n        this.currentStepNode.hide();\n        if (this.currentStepPopper) {\n            this.currentStepPopper.destroy();\n        }\n    }\n\n    // Restore original target configuration.\n    if (this.currentStepConfig) {\n        var target = this.getStepTarget(this.currentStepConfig);\n        if (target) {\n            if (target.data('original-labelledby')) {\n                target.attr('aria-labelledby', target.data('original-labelledby'));\n            }\n\n            if (target.data('original-describedby')) {\n                target.attr('aria-describedby', target.data('original-describedby'));\n            }\n\n            if (target.data('original-tabindex')) {\n                target.attr('tabindex', target.data('tabindex'));\n            }\n        }\n\n        // Clear the step configuration.\n        this.currentStepConfig = null;\n    }\n\n    var fadeTime = 0;\n    if (transition) {\n        fadeTime = 400;\n    }\n\n    // Remove the backdrop features.\n    $('[data-flexitour=\"step-background\"]').remove();\n    $('[data-flexitour=\"step-backdrop\"]').removeAttr('data-flexitour');\n    $('[data-flexitour=\"backdrop\"]').fadeOut(fadeTime, function () {\n        $(this).remove();\n    });\n\n    // Remove aria-describedby and tabindex attributes.\n    if (this.currentStepNode && this.currentStepNode.length) {\n        var stepId = this.currentStepNode.attr('id');\n        if (stepId) {\n            var currentStepElement = '[aria-describedby=\"' + stepId + '-body\"]';\n            $(currentStepElement).removeAttr('tabindex');\n            $(currentStepElement).removeAttr('aria-describedby');\n        }\n    }\n\n    // Reset the listeners.\n    this.resetStepListeners();\n\n    this.accessibilityHide();\n\n    this.fireEventHandlers('afterHide');\n\n    this.currentStepNode = null;\n    this.currentStepPopper = null;\n    return this;\n};\n\n/**\n * Show the current steps.\n *\n * @method show\n * @chainable\n */\nTour.prototype.show = function () {\n    // Show the current step.\n    var startAt = this.getCurrentStepNumber();\n\n    return this.gotoStep(startAt);\n};\n\n/**\n * Return the current step node.\n *\n * @method  getStepContainer\n * @return  {jQuery}\n */\nTour.prototype.getStepContainer = function () {\n    return $(this.currentStepNode);\n};\n\n/**\n * Calculate scrollTop.\n *\n * @method  calculateScrollTop\n * @param   {Object}    stepConfig      The step configuration of the step\n * @return  {Number}\n */\nTour.prototype.calculateScrollTop = function (stepConfig) {\n    var scrollTop = $(window).scrollTop();\n    var viewportHeight = $(window).height();\n    var targetNode = this.getStepTarget(stepConfig);\n\n    if (stepConfig.placement === 'top') {\n        // If the placement is top, center scroll at the top of the target.\n        scrollTop = targetNode.offset().top - viewportHeight / 2;\n    } else if (stepConfig.placement === 'bottom') {\n        // If the placement is bottom, center scroll at the bottom of the target.\n        scrollTop = targetNode.offset().top + targetNode.height() - viewportHeight / 2;\n    } else if (targetNode.height() <= viewportHeight * 0.8) {\n        // If the placement is left/right, and the target fits in the viewport, centre screen on the target\n        scrollTop = targetNode.offset().top - (viewportHeight - targetNode.height()) / 2;\n    } else {\n        // If the placement is left/right, and the target is bigger than the viewport, set scrollTop to target.top + buffer\n        // and change step attachmentTarget to top+.\n        scrollTop = targetNode.offset().top - viewportHeight * 0.2;\n    }\n\n    // Never scroll over the top.\n    scrollTop = Math.max(0, scrollTop);\n\n    // Never scroll beyond the bottom.\n    scrollTop = Math.min($(document).height() - viewportHeight, scrollTop);\n\n    return Math.ceil(scrollTop);\n};\n\n/**\n * Calculate dialogue position for page middle.\n *\n * @method  calculateScrollTop\n * @return  {Number}\n */\nTour.prototype.calculateStepPositionInPage = function () {\n    var viewportHeight = $(window).height();\n    var stepHeight = this.currentStepNode.height();\n\n    var viewportWidth = $(window).width();\n    var stepWidth = this.currentStepNode.width();\n\n    return {\n        top: Math.ceil((viewportHeight - stepHeight) / 2),\n        left: Math.ceil((viewportWidth - stepWidth) / 2)\n    };\n};\n\n/**\n * Position the step on the page.\n *\n * @method  positionStep\n * @param   {Object}    stepConfig      The step configuration of the step\n * @chainable\n */\nTour.prototype.positionStep = function (stepConfig) {\n    var content = this.currentStepNode;\n    if (!content || !content.length) {\n        // Unable to find the step node.\n        return this;\n    }\n\n    var flipBehavior = void 0;\n    switch (stepConfig.placement) {\n        case 'left':\n            flipBehavior = ['left', 'right', 'top', 'bottom'];\n            break;\n        case 'right':\n            flipBehavior = ['right', 'left', 'top', 'bottom'];\n            break;\n        case 'top':\n            flipBehavior = ['top', 'bottom', 'right', 'left'];\n            break;\n        case 'bottom':\n            flipBehavior = ['bottom', 'top', 'right', 'left'];\n            break;\n        default:\n            flipBehavior = 'flip';\n            break;\n    }\n\n    var target = this.getStepTarget(stepConfig);\n    var config = {\n        placement: stepConfig.placement + '-start',\n        removeOnDestroy: true,\n        modifiers: {\n            flip: {\n                behaviour: flipBehavior\n            },\n            arrow: {\n                element: '[data-role=\"arrow\"]'\n            }\n        },\n        onCreate: function onCreate(data) {\n            recalculateArrowPosition(data);\n        },\n        onUpdate: function onUpdate(data) {\n            recalculateArrowPosition(data);\n        }\n    };\n\n    var recalculateArrowPosition = function recalculateArrowPosition(data) {\n        var placement = data.placement.split('-')[0];\n        var isVertical = ['left', 'right'].indexOf(placement) !== -1;\n        var arrowElement = data.instance.popper.querySelector('[data-role=\"arrow\"]');\n        var stepElement = $(data.instance.popper.querySelector('[data-role=\"flexitour-step\"]'));\n        if (isVertical) {\n            var arrowHeight = parseFloat(window.getComputedStyle(arrowElement).height);\n            var arrowOffset = parseFloat(window.getComputedStyle(arrowElement).top);\n            var popperHeight = parseFloat(window.getComputedStyle(data.instance.popper).height);\n            var popperOffset = parseFloat(window.getComputedStyle(data.instance.popper).top);\n            var popperBorderWidth = parseFloat(stepElement.css('borderTopWidth'));\n            var popperBorderRadiusWidth = parseFloat(stepElement.css('borderTopLeftRadius')) * 2;\n            var arrowPos = arrowOffset + arrowHeight / 2;\n            var maxPos = popperHeight + popperOffset - popperBorderWidth - popperBorderRadiusWidth;\n            var minPos = popperOffset + popperBorderWidth + popperBorderRadiusWidth;\n            if (arrowPos >= maxPos || arrowPos <= minPos) {\n                var newArrowPos = 0;\n                if (arrowPos > popperHeight / 2) {\n                    newArrowPos = maxPos - arrowHeight;\n                } else {\n                    newArrowPos = minPos + arrowHeight;\n                }\n                $(arrowElement).css('top', newArrowPos);\n            }\n        } else {\n            var arrowWidth = parseFloat(window.getComputedStyle(arrowElement).width);\n            var _arrowOffset = parseFloat(window.getComputedStyle(arrowElement).left);\n            var popperWidth = parseFloat(window.getComputedStyle(data.instance.popper).width);\n            var _popperOffset = parseFloat(window.getComputedStyle(data.instance.popper).left);\n            var _popperBorderWidth = parseFloat(stepElement.css('borderTopWidth'));\n            var _popperBorderRadiusWidth = parseFloat(stepElement.css('borderTopLeftRadius')) * 2;\n            var _arrowPos = _arrowOffset + arrowWidth / 2;\n            var _maxPos = popperWidth + _popperOffset - _popperBorderWidth - _popperBorderRadiusWidth;\n            var _minPos = _popperOffset + _popperBorderWidth + _popperBorderRadiusWidth;\n            if (_arrowPos >= _maxPos || _arrowPos <= _minPos) {\n                var _newArrowPos = 0;\n                if (_arrowPos > popperWidth / 2) {\n                    _newArrowPos = _maxPos - arrowWidth;\n                } else {\n                    _newArrowPos = _minPos + arrowWidth;\n                }\n                $(arrowElement).css('left', _newArrowPos);\n            }\n        }\n    };\n\n    var background = $('[data-flexitour=\"step-background\"]');\n    if (background.length) {\n        target = background;\n    }\n    this.currentStepPopper = new Popper(target, content[0], config);\n\n    return this;\n};\n\n/**\n * Add the backdrop.\n *\n * @method  positionBackdrop\n * @param   {Object}    stepConfig      The step configuration of the step\n * @chainable\n */\nTour.prototype.positionBackdrop = function (stepConfig) {\n    if (stepConfig.backdrop) {\n        this.currentStepConfig.hasBackdrop = true;\n        var backdrop = $('<div data-flexitour=\"backdrop\"></div>');\n\n        if (stepConfig.zIndex) {\n            if (stepConfig.attachPoint === 'append') {\n                stepConfig.attachTo.append(backdrop);\n            } else {\n                backdrop.insertAfter(stepConfig.attachTo);\n            }\n        } else {\n            $('body').append(backdrop);\n        }\n\n        if (this.isStepActuallyVisible(stepConfig)) {\n            // The step has a visible target.\n            // Punch a hole through the backdrop.\n            var background = $('<div data-flexitour=\"step-background\"></div>');\n\n            var targetNode = this.getStepTarget(stepConfig);\n\n            var buffer = 10;\n\n            var colorNode = targetNode;\n            if (buffer) {\n                colorNode = $('body');\n            }\n\n            background.css({\n                width: targetNode.outerWidth() + buffer + buffer,\n                height: targetNode.outerHeight() + buffer + buffer,\n                left: targetNode.offset().left - buffer,\n                top: targetNode.offset().top - buffer,\n                backgroundColor: this.calculateInherittedBackgroundColor(colorNode)\n            });\n\n            if (targetNode.offset().left < buffer) {\n                background.css({\n                    width: targetNode.outerWidth() + targetNode.offset().left + buffer,\n                    left: targetNode.offset().left\n                });\n            }\n\n            if (targetNode.offset().top < buffer) {\n                background.css({\n                    height: targetNode.outerHeight() + targetNode.offset().top + buffer,\n                    top: targetNode.offset().top\n                });\n            }\n\n            var targetRadius = targetNode.css('borderRadius');\n            if (targetRadius && targetRadius !== $('body').css('borderRadius')) {\n                background.css('borderRadius', targetRadius);\n            }\n\n            var targetPosition = this.calculatePosition(targetNode);\n            if (targetPosition === 'fixed') {\n                background.css('top', 0);\n            } else if (targetPosition === 'absolute') {\n                background.css('position', 'fixed');\n            }\n\n            var fader = background.clone();\n            fader.css({\n                backgroundColor: backdrop.css('backgroundColor'),\n                opacity: backdrop.css('opacity')\n            });\n            fader.attr('data-flexitour', 'step-background-fader');\n\n            if (stepConfig.zIndex) {\n                if (stepConfig.attachPoint === 'append') {\n                    stepConfig.attachTo.append(background);\n                } else {\n                    fader.insertAfter(stepConfig.attachTo);\n                    background.insertAfter(stepConfig.attachTo);\n                }\n            } else {\n                $('body').append(fader);\n                $('body').append(background);\n            }\n\n            // Add the backdrop data to the actual target.\n            // This is the part which actually does the work.\n            targetNode.attr('data-flexitour', 'step-backdrop');\n\n            if (stepConfig.zIndex) {\n                backdrop.css('zIndex', stepConfig.zIndex);\n                background.css('zIndex', stepConfig.zIndex + 1);\n                targetNode.css('zIndex', stepConfig.zIndex + 2);\n            }\n\n            fader.fadeOut('2000', function () {\n                $(this).remove();\n            });\n        }\n    }\n    return this;\n};\n\n/**\n * Calculate the inheritted z-index.\n *\n * @method  calculateZIndex\n * @param   {jQuery}    elem                        The element to calculate z-index for\n * @return  {Number}                                Calculated z-index\n */\nTour.prototype.calculateZIndex = function (elem) {\n    elem = $(elem);\n    while (elem.length && elem[0] !== document) {\n        // Ignore z-index if position is set to a value where z-index is ignored by the browser\n        // This makes behavior of this function consistent across browsers\n        // WebKit always returns auto if the element is positioned.\n        var position = elem.css(\"position\");\n        if (position === \"absolute\" || position === \"relative\" || position === \"fixed\") {\n            // IE returns 0 when zIndex is not specified\n            // other browsers return a string\n            // we ignore the case of nested elements with an explicit value of 0\n            // <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\n            var value = parseInt(elem.css(\"zIndex\"), 10);\n            if (!isNaN(value) && value !== 0) {\n                return value;\n            }\n        }\n        elem = elem.parent();\n    }\n\n    return 0;\n};\n\n/**\n * Calculate the inheritted background colour.\n *\n * @method  calculateInherittedBackgroundColor\n * @param   {jQuery}    elem                        The element to calculate colour for\n * @return  {String}                                Calculated background colour\n */\nTour.prototype.calculateInherittedBackgroundColor = function (elem) {\n    // Use a fake node to compare each element against.\n    var fakeNode = $('<div>').hide();\n    $('body').append(fakeNode);\n    var fakeElemColor = fakeNode.css('backgroundColor');\n    fakeNode.remove();\n\n    elem = $(elem);\n    while (elem.length && elem[0] !== document) {\n        var color = elem.css('backgroundColor');\n        if (color !== fakeElemColor) {\n            return color;\n        }\n        elem = elem.parent();\n    }\n\n    return null;\n};\n\n/**\n * Calculate the inheritted position.\n *\n * @method  calculatePosition\n * @param   {jQuery}    elem                        The element to calculate position for\n * @return  {String}                                Calculated position\n */\nTour.prototype.calculatePosition = function (elem) {\n    elem = $(elem);\n    while (elem.length && elem[0] !== document) {\n        var position = elem.css('position');\n        if (position !== 'static') {\n            return position;\n        }\n        elem = elem.parent();\n    }\n\n    return null;\n};\n\n/**\n * Perform accessibility changes for step shown.\n *\n * This will add aria-hidden=\"true\" to all siblings and parent siblings.\n *\n * @method  accessibilityShow\n */\nTour.prototype.accessibilityShow = function () {\n    var stateHolder = 'data-has-hidden';\n    var attrName = 'aria-hidden';\n    var hideFunction = function hideFunction(child) {\n        var flexitourRole = child.data('flexitour');\n        if (flexitourRole) {\n            switch (flexitourRole) {\n                case 'container':\n                case 'target':\n                    return;\n            }\n        }\n\n        var hidden = child.attr(attrName);\n        if (!hidden) {\n            child.attr(stateHolder, true);\n            child.attr(attrName, true);\n        }\n    };\n\n    this.currentStepNode.siblings().each(function (index, node) {\n        hideFunction($(node));\n    });\n    this.currentStepNode.parentsUntil('body').siblings().each(function (index, node) {\n        hideFunction($(node));\n    });\n};\n\n/**\n * Perform accessibility changes for step hidden.\n *\n * This will remove any newly added aria-hidden=\"true\".\n *\n * @method  accessibilityHide\n */\nTour.prototype.accessibilityHide = function () {\n    var stateHolder = 'data-has-hidden';\n    var attrName = 'aria-hidden';\n    var showFunction = function showFunction(child) {\n        var hidden = child.attr(stateHolder);\n        if (typeof hidden !== 'undefined') {\n            child.removeAttr(stateHolder);\n            child.removeAttr(attrName);\n        }\n    };\n\n    $('[' + stateHolder + ']').each(function (index, node) {\n        showFunction($(node));\n    });\n};\n\nif ((typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) === 'object') {\n    module.exports = Tour;\n}\n\nreturn Tour;\n\n}));\n"],"file":"tour.min.js"}