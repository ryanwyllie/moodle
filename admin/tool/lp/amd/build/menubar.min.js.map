{"version":3,"sources":["../src/menubar.js"],"names":["define","$","documentClickHandlerRegistered","menuActive","closeAllSubMenus","attr","Menubar","menuRoot","handlers","rootMenus","children","subMenus","subMenuItems","allItems","add","activeItem","isChildOpen","keys","tab","enter","esc","space","left","up","right","down","addAriaAttributes","addEventListeners","prototype","openSubMenu","menu","setOpenDirection","currentThis","document","click","mouseenter","addClass","mouseout","removeClass","e","handleClick","keydown","handleKeyDown","focus","handleFocus","blur","handleBlur","item","stopPropagation","parentUL","parent","is","first","find","not","anchor","clickEvent","Event","target","eventHandled","each","selector","handler","length","callable","proxy","isDefaultPrevented","window","location","href","parentItems","parentsUntil","filter","itemUL","pos","offset","isRTL","body","hasClass","heightmenuRoot","outerHeight","widthmenuRoot","outerWidth","subMenuContainer","css","menuRealWidth","menuRealHeight","margintop","marginright","marginleft","top","scrollTop","height","width","altKey","ctrlKey","keyCode","moveToPrevious","moveToNext","moveUp","moveDown","menuItems","menuNum","menuIndex","index","newItem","childMenu","next","parentMenus","rootItem","last","prev","parentLI","startChr","newItemUL","match","curNdx","titleChr","eq","html","charAt","toLowerCase","enhance","element","data","closeAll"],"mappings":"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","file":"menubar.min.js","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Aria menubar functionality. Enhances a simple nested list structure into a full aria widget.\n * Based on the open ajax example: http://oaa-accessibility.org/example/26/\n *\n * @module     tool_lp/menubar\n * @package    tool_lp\n * @copyright  2015 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery'], function($) {\n\n    /** @property {boolean}  Flag to indicate if we have already registered a click event handler for the document. */\n    var documentClickHandlerRegistered = false;\n\n    /** @property {boolean} Flag to indicate whether there's an active, open menu. */\n    var menuActive = false;\n\n    /**\n     * Close all open submenus anywhere in the page (there should only ever be one open at a time).\n     *\n     * @method closeAllSubMenus\n     */\n    var closeAllSubMenus = function() {\n        $('.tool-lp-menu .tool-lp-sub-menu').attr('aria-hidden', 'true');\n        // Every menu's closed at this point, so set the menu active flag to false.\n        menuActive = false;\n    };\n\n    /**\n     * Constructor\n     *\n     * @param {$} menuRoot Jquery collection matching the root of the menu.\n     * @param {Function[]} handlers, called when a menu item is chosen.\n     */\n    var Menubar = function(menuRoot, handlers) {\n        // Setup private class variables.\n        this.menuRoot = menuRoot;\n        this.handlers = handlers;\n        this.rootMenus = this.menuRoot.children('li');\n        this.subMenus = this.rootMenus.children('ul');\n        this.subMenuItems = this.subMenus.children('li');\n        this.allItems = this.rootMenus.add(this.subMenuItems);\n        this.activeItem = null;\n        this.isChildOpen = false;\n\n        this.keys = {\n            tab:    9,\n            enter:  13,\n            esc:    27,\n            space:  32,\n            left:   37,\n            up:     38,\n            right:  39,\n            down:   40\n        };\n\n        this.addAriaAttributes();\n        // Add the event listeners.\n        this.addEventListeners();\n    };\n\n    /**\n     * Open a submenu, first it closes all other sub-menus and sets the open direction.\n     * @method openSubMenu\n     * @param {Node} menu\n     */\n    Menubar.prototype.openSubMenu = function(menu) {\n        this.setOpenDirection();\n        closeAllSubMenus();\n        menu.attr('aria-hidden', 'false');\n        // Set menu active flag to true when a menu is opened.\n        menuActive = true;\n    };\n\n\n    /**\n     * Bind the event listeners to the DOM\n     * @method addEventListeners\n     */\n    Menubar.prototype.addEventListeners = function() {\n        var currentThis = this;\n\n        // When clicking outside the menubar.\n        if (documentClickHandlerRegistered === false) {\n            $(document).click(function() {\n                // Check if a menu is opened.\n                if (menuActive) {\n                    // Close menu.\n                    closeAllSubMenus();\n                }\n            });\n            // Set this flag to true so that we won't need to add a document click handler for the other Menubar instances.\n            documentClickHandlerRegistered = true;\n        }\n\n        // Hovers.\n        this.subMenuItems.mouseenter(function() {\n            $(this).addClass('menu-hover');\n            return true;\n        });\n\n        this.subMenuItems.mouseout(function() {\n            $(this).removeClass('menu-hover');\n            return true;\n        });\n\n        // Mouse listeners.\n        this.allItems.click(function(e) {\n            return currentThis.handleClick($(this), e);\n        });\n\n        // Key listeners.\n        this.allItems.keydown(function(e) {\n            return currentThis.handleKeyDown($(this), e);\n        });\n\n        this.allItems.focus(function() {\n            return currentThis.handleFocus($(this));\n        });\n\n        this.allItems.blur(function() {\n            return currentThis.handleBlur($(this));\n        });\n    };\n\n    /**\n     * Process click events for the top menus.\n     *\n     * @method handleClick\n     * @param {Object} item is the jquery object of the item firing the event\n     * @param {Event} e is the associated event object\n     * @return {boolean} Returns false\n     */\n    Menubar.prototype.handleClick = function(item, e) {\n        e.stopPropagation();\n\n        var parentUL = item.parent();\n\n        if (parentUL.is('.tool-lp-menu')) {\n            // Toggle the child menu open/closed.\n            if (item.children('ul').first().attr('aria-hidden') == 'true') {\n                this.openSubMenu(item.children('ul').first());\n            } else {\n                item.children('ul').first().attr('aria-hidden', 'true');\n            }\n        } else {\n            // Remove hover and focus styling.\n            this.allItems.removeClass('menu-hover menu-focus');\n\n            // Clear the active item.\n            this.activeItem = null;\n\n            // Close the menu.\n            this.menuRoot.find('ul').not('.root-level').attr('aria-hidden', 'true');\n            // Follow any link, or call the click handlers.\n            var anchor = item.find('a').first();\n            var clickEvent = new $.Event('click');\n            clickEvent.target = anchor;\n            var eventHandled = false;\n            if (this.handlers) {\n                $.each(this.handlers, function(selector, handler) {\n                    if (eventHandled) {\n                        return;\n                    }\n                    if (item.find(selector).length > 0) {\n                        var callable = $.proxy(handler, anchor);\n                        // False means stop propogatting events.\n                        eventHandled = (callable(clickEvent) === false) || clickEvent.isDefaultPrevented();\n                    }\n                });\n            }\n            // If we didn't find a handler, and the HREF is # that probably means that\n            // we are handling it from somewhere else. Let's just do nothing in that case.\n            if (!eventHandled && anchor.attr('href') !== '#') {\n                window.location.href = anchor.attr('href');\n            }\n        }\n        return false;\n    };\n\n    /*\n     * Process focus events for the menu.\n     *\n     * @method handleFocus\n     * @param {Object} item is the jquery object of the item firing the event\n     * @return boolean Returns false\n     */\n    Menubar.prototype.handleFocus = function(item) {\n\n        // If activeItem is null, we are getting focus from outside the menu. Store\n        // the item that triggered the event.\n        if (this.activeItem === null) {\n            this.activeItem = item;\n        } else if (item[0] != this.activeItem[0]) {\n            return true;\n        }\n\n        // Get the set of jquery objects for all the parent items of the active item.\n        var parentItems = this.activeItem.parentsUntil('ul.tool-lp-menu').filter('li');\n\n        // Remove focus styling from all other menu items.\n        this.allItems.removeClass('menu-focus');\n\n        // Add focus styling to the active item.\n        this.activeItem.addClass('menu-focus');\n\n        // Add focus styling to all parent items.\n        parentItems.addClass('menu-focus');\n\n        // If the bChildOpen flag has been set, open the active item's child menu (if applicable).\n        if (this.isChildOpen === true) {\n\n            var itemUL = item.parent();\n\n            // If the itemUL is a root-level menu and item is a parent item,\n            // show the child menu.\n            if (itemUL.is('.tool-lp-menu') && (item.attr('aria-haspopup') == 'true')) {\n                this.openSubMenu(item.children('ul').first());\n            }\n        }\n\n        return true;\n    };\n\n    /*\n     * Process blur events for the menu.\n     *\n     * @method handleBlur\n     * @param {Object} item is the jquery object of the item firing the event\n     * @return boolean Returns false\n     */\n    Menubar.prototype.handleBlur = function(item) {\n        item.removeClass('menu-focus');\n\n        return true;\n    };\n\n    /*\n     * Determine if the menu should open to the left, or the right,\n     * based on the screen size and menu position.\n     * @method setOpenDirection\n     */\n    Menubar.prototype.setOpenDirection = function() {\n        var pos = this.menuRoot.offset();\n        var isRTL = $(document.body).hasClass('dir-rtl');\n        var openLeft = true;\n        var heightmenuRoot = this.rootMenus.outerHeight();\n        var widthmenuRoot = this.rootMenus.outerWidth();\n        // Sometimes the menuMinWidth is not enough to figure out if menu exceeds the window width.\n        // So we have to calculate the real menu width.\n        var subMenuContainer = this.rootMenus.find('ul.tool-lp-sub-menu');\n\n        // Reset margins.\n        subMenuContainer.css('margin-right', '');\n        subMenuContainer.css('margin-left', '');\n        subMenuContainer.css('margin-top', '');\n\n        subMenuContainer.attr('aria-hidden', false);\n        var menuRealWidth = subMenuContainer.outerWidth(),\n            menuRealHeight = subMenuContainer.outerHeight();\n\n        var margintop = null,\n            marginright = null,\n            marginleft = null;\n        var top = pos.top - $(window).scrollTop();\n        // Top is the same for RTL and LTR.\n        if (top + menuRealHeight > $(window).height()) {\n            margintop = menuRealHeight + heightmenuRoot;\n            subMenuContainer.css('margin-top', '-' + margintop + 'px');\n        }\n\n        if (isRTL) {\n            if (pos.left - menuRealWidth < 0) {\n                marginright = menuRealWidth - widthmenuRoot;\n                subMenuContainer.css('margin-right', '-' + marginright + 'px');\n            }\n        } else {\n            if (pos.left + menuRealWidth > $(window).width()) {\n                marginleft = menuRealWidth - widthmenuRoot;\n                subMenuContainer.css('margin-left', '-' + marginleft + 'px');\n            }\n        }\n\n        if (openLeft) {\n            this.menuRoot.addClass('tool-lp-menu-open-left');\n        } else {\n            this.menuRoot.removeClass('tool-lp-menu-open-left');\n        }\n\n    };\n\n    /*\n     * Process keyDown events for the menu.\n     *\n     * @method handleKeyDown\n     * @param {Object} item is the jquery object of the item firing the event\n     * @param {Event} e is the associated event object\n     * @return boolean Returns false if consuming the event\n     */\n    Menubar.prototype.handleKeyDown = function(item, e) {\n\n        if (e.altKey || e.ctrlKey) {\n            // Modifier key pressed: Do not process.\n            return true;\n        }\n\n        switch (e.keyCode) {\n            case this.keys.tab: {\n\n                // Hide all menu items and update their aria attributes.\n                this.menuRoot.find('ul').attr('aria-hidden', 'true');\n\n                // Remove focus styling from all menu items.\n                this.allItems.removeClass('menu-focus');\n\n                this.activeItem = null;\n\n                this.isChildOpen = false;\n\n                break;\n            }\n            case this.keys.esc: {\n                var itemUL = item.parent();\n\n                if (itemUL.is('.tool-lp-menu')) {\n                    // Hide the child menu and update the aria attributes.\n                    item.children('ul').first().attr('aria-hidden', 'true');\n                } else {\n\n                    // Move up one level.\n                    this.activeItem = itemUL.parent();\n\n                    // Reset the isChildOpen flag.\n                    this.isChildOpen = false;\n\n                    // Set focus on the new item.\n                    this.activeItem.focus();\n\n                    // Hide the active menu and update the aria attributes.\n                    itemUL.attr('aria-hidden', 'true');\n                }\n\n                e.stopPropagation();\n                return false;\n            }\n            case this.keys.enter:\n            case this.keys.space: {\n                // Trigger click handler.\n                return this.handleClick(item, e);\n            }\n\n            case this.keys.left: {\n\n                this.activeItem = this.moveToPrevious(item);\n\n                this.activeItem.focus();\n\n                e.stopPropagation();\n                return false;\n            }\n            case this.keys.right: {\n\n                this.activeItem = this.moveToNext(item);\n\n                this.activeItem.focus();\n\n                e.stopPropagation();\n                return false;\n            }\n            case this.keys.up: {\n\n                this.activeItem = this.moveUp(item);\n\n                this.activeItem.focus();\n\n                e.stopPropagation();\n                return false;\n            }\n            case this.keys.down: {\n\n                this.activeItem = this.moveDown(item);\n\n                this.activeItem.focus();\n\n                e.stopPropagation();\n                return false;\n            }\n        }\n\n        return true;\n\n    };\n\n\n    /**\n     * Move to the next menu level.\n     * This will be either the next root-level menu or the child of a menu parent. If\n     * at the root level and the active item is the last in the menu, this function will loop\n     * to the first menu item.\n     *\n     * If the menu is a horizontal menu, the first child element of the newly selected menu will\n     * be selected\n     *\n     * @method moveToNext\n     * @param {Object} item is the active menu item\n     * @return {Object} Returns the item to move to. Returns item is no move is possible\n     */\n    Menubar.prototype.moveToNext = function(item) {\n        // Item's containing menu.\n        var itemUL = item.parent();\n\n        // The items in the currently active menu.\n        var menuItems = itemUL.children('li');\n\n        // The number of items in the active menu.\n        var menuNum = menuItems.length;\n        // The items index in its menu.\n        var menuIndex = menuItems.index(item);\n        var newItem = null;\n        var childMenu = null;\n\n        if (itemUL.is('.tool-lp-menu')) {\n            // This is the root level move to next sibling. This will require closing\n            // the current child menu and opening the new one.\n\n            if (menuIndex < menuNum - 1) {\n                // Not the last root menu.\n                newItem = item.next();\n            } else { // Wrap to first item.\n                newItem = menuItems.first();\n            }\n\n            // Close the current child menu (if applicable).\n            if (item.attr('aria-haspopup') == 'true') {\n\n                childMenu = item.children('ul').first();\n\n                if (childMenu.attr('aria-hidden') == 'false') {\n                    // Update the child menu's aria-hidden attribute.\n                    childMenu.attr('aria-hidden', 'true');\n                    this.isChildOpen = true;\n                }\n            }\n\n            // Remove the focus styling from the current menu.\n            item.removeClass('menu-focus');\n\n            // Open the new child menu (if applicable).\n            if ((newItem.attr('aria-haspopup') === 'true') && (this.isChildOpen === true)) {\n\n                childMenu = newItem.children('ul').first();\n\n                // Update the child's aria-hidden attribute.\n                this.openSubMenu(childMenu);\n            }\n        } else {\n            // This is not the root level. If there is a child menu to be moved into, do that;\n            // otherwise, move to the next root-level menu if there is one.\n            if (item.attr('aria-haspopup') == 'true') {\n\n                childMenu = item.children('ul').first();\n\n                newItem = childMenu.children('li').first();\n\n                // Show the child menu and update its aria attributes.\n                this.openSubMenu(childMenu);\n            } else {\n                // At deepest level, move to the next root-level menu.\n\n                var parentMenus = null;\n                var rootItem = null;\n\n                // Get list of all parent menus for item, up to the root level.\n                parentMenus = item.parentsUntil('ul.tool-lp-menu').filter('ul').not('.tool-lp-menu');\n\n                // Hide the current menu and update its aria attributes accordingly.\n                parentMenus.attr('aria-hidden', 'true');\n\n                // Remove the focus styling from the active menu.\n                parentMenus.find('li').removeClass('menu-focus');\n                parentMenus.last().parent().removeClass('menu-focus');\n\n                // The containing root for the menu.\n                rootItem = parentMenus.last().parent();\n\n                menuIndex = this.rootMenus.index(rootItem);\n\n                // If this is not the last root menu item, move to the next one.\n                if (menuIndex < this.rootMenus.length - 1) {\n                    newItem = rootItem.next();\n                } else {\n                    // Loop.\n                    newItem = this.rootMenus.first();\n                }\n\n                // Add the focus styling to the new menu.\n                newItem.addClass('menu-focus');\n\n                if (newItem.attr('aria-haspopup') == 'true') {\n                    childMenu = newItem.children('ul').first();\n\n                    newItem = childMenu.children('li').first();\n\n                    // Show the child menu and update it's aria attributes.\n                    this.openSubMenu(childMenu);\n                    this.isChildOpen = true;\n                }\n            }\n        }\n\n        return newItem;\n    };\n\n    /**\n     * Member function to move to the previous menu level.\n     * This will be either the previous root-level menu or the child of a menu parent. If\n     * at the root level and the active item is the first in the menu, this function will loop\n     * to the last menu item.\n     *\n     * If the menu is a horizontal menu, the first child element of the newly selected menu will\n     * be selected\n     *\n     * @method moveToPrevious\n     * @param {Object} item is the active menu item\n     * @return {Object} Returns the item to move to. Returns item is no move is possible\n     */\n    Menubar.prototype.moveToPrevious = function(item) {\n        // Item's containing menu.\n        var itemUL = item.parent();\n        // The items in the currently active menu.\n        var menuItems = itemUL.children('li');\n        // The items index in its menu.\n        var menuIndex = menuItems.index(item);\n        var newItem = null;\n        var childMenu = null;\n\n        if (itemUL.is('.tool-lp-menu')) {\n            // This is the root level move to previous sibling. This will require closing\n            // the current child menu and opening the new one.\n\n            if (menuIndex > 0) {\n                // Not the first root menu.\n                newItem = item.prev();\n            } else {\n                // Wrap to last item.\n                newItem = menuItems.last();\n            }\n\n            // Close the current child menu (if applicable).\n            if (item.attr('aria-haspopup') == 'true') {\n                childMenu = item.children('ul').first();\n\n                if (childMenu.attr('aria-hidden') == 'false') {\n                    // Update the child menu's aria-hidden attribute.\n                    childMenu.attr('aria-hidden', 'true');\n                    this.isChildOpen = true;\n                }\n            }\n\n            // Remove the focus styling from the current menu.\n            item.removeClass('menu-focus');\n\n            // Open the new child menu (if applicable).\n            if ((newItem.attr('aria-haspopup') === 'true') && (this.isChildOpen === true)) {\n\n                childMenu = newItem.children('ul').first();\n\n                // Update the child's aria-hidden attribute.\n                this.openSubMenu(childMenu);\n\n            }\n        } else {\n            // This is not the root level. If there is a parent menu that is not the\n            // root menu, move up one level; otherwise, move to first item of the previous\n            // root menu.\n\n            var parentLI = itemUL.parent();\n            var parentUL = parentLI.parent();\n\n            // If this is a vertical menu or is not the first child menu\n            // of the root-level menu, move up one level.\n            if (!parentUL.is('.tool-lp-menu')) {\n\n                newItem = itemUL.parent();\n\n                // Hide the active menu and update aria-hidden.\n                itemUL.attr('aria-hidden', 'true');\n\n                // Remove the focus highlight from the item.\n                item.removeClass('menu-focus');\n\n            } else {\n                // Move to previous root-level menu.\n\n                // Hide the current menu and update the aria attributes accordingly.\n                itemUL.attr('aria-hidden', 'true');\n\n                // Remove the focus styling from the active menu.\n                item.removeClass('menu-focus');\n                parentLI.removeClass('menu-focus');\n\n                menuIndex = this.rootMenus.index(parentLI);\n\n                if (menuIndex > 0) {\n                    // Move to the previous root-level menu.\n                    newItem = parentLI.prev();\n                } else {\n                    // Loop to last root-level menu.\n                    newItem = this.rootMenus.last();\n                }\n\n                // Add the focus styling to the new menu.\n                newItem.addClass('menu-focus');\n\n                if (newItem.attr('aria-haspopup') == 'true') {\n                    childMenu = newItem.children('ul').first();\n\n                    // Show the child menu and update it's aria attributes.\n                    this.openSubMenu(childMenu);\n                    this.isChildOpen = true;\n\n                    newItem = childMenu.children('li').first();\n                }\n            }\n        }\n\n        return newItem;\n    };\n\n    /**\n     * Member function to select the next item in a menu.\n     * If the active item is the last in the menu, this function will loop to the\n     * first menu item.\n     *\n     * @method moveDown\n     * @param {Object} item is the active menu item\n     * @param {String} startChr is the character to attempt to match against the beginning of the\n     *                          menu item titles. If found, focus moves to the next menu item beginning with that character.\n     * @return {Object} Returns the item to move to. Returns item is no move is possible\n     */\n    Menubar.prototype.moveDown = function(item, startChr) {\n        // Item's containing menu.\n        var itemUL = item.parent();\n        // The items in the currently active menu.\n        var menuItems = itemUL.children('li').not('.separator');\n        // The number of items in the active menu.\n        var menuNum = menuItems.length;\n        // The items index in its menu.\n        var menuIndex = menuItems.index(item);\n        var newItem = null;\n        var newItemUL = null;\n\n        if (itemUL.is('.tool-lp-menu')) {\n            // This is the root level menu.\n\n            if (item.attr('aria-haspopup') != 'true') {\n                // No child menu to move to.\n                return item;\n            }\n\n            // Move to the first item in the child menu.\n            newItemUL = item.children('ul').first();\n            newItem = newItemUL.children('li').first();\n\n            // Make sure the child menu is visible.\n            this.openSubMenu(newItemUL);\n\n            return newItem;\n        }\n\n        // If $item is not the last item in its menu, move to the next item. If startChr is specified, move\n        // to the next item with a title that begins with that character.\n        if (startChr) {\n            var match = false;\n            var curNdx = menuIndex + 1;\n\n            // Check if the active item was the last one on the list.\n            if (curNdx == menuNum) {\n                curNdx = 0;\n            }\n\n            // Iterate through the menu items (starting from the current item and wrapping) until a match is found\n            // or the loop returns to the current menu item.\n            while (curNdx != menuIndex) {\n\n                var titleChr = menuItems.eq(curNdx).html().charAt(0);\n\n                if (titleChr.toLowerCase() == startChr) {\n                    match = true;\n                    break;\n                }\n\n                curNdx = curNdx + 1;\n\n                if (curNdx == menuNum) {\n                    // Reached the end of the list, start again at the beginning.\n                    curNdx = 0;\n                }\n            }\n\n            if (match === true) {\n                newItem = menuItems.eq(curNdx);\n\n                // Remove the focus styling from the current item.\n                item.removeClass('menu-focus');\n\n                return newItem;\n            } else {\n                return item;\n            }\n        } else {\n            if (menuIndex < menuNum - 1) {\n                newItem = menuItems.eq(menuIndex + 1);\n            } else {\n                newItem = menuItems.first();\n            }\n        }\n\n        // Remove the focus styling from the current item.\n        item.removeClass('menu-focus');\n\n        return newItem;\n    };\n\n    /**\n     * Function moveUp() is a member function to select the previous item in a menu.\n     * If the active item is the first in the menu, this function will loop to the\n     * last menu item.\n     *\n     * @method moveUp\n     * @param {Object} item is the active menu item\n     * @return {Object} Returns the item to move to. Returns item is no move is possible\n     */\n    Menubar.prototype.moveUp = function(item) {\n        // Item's containing menu.\n        var itemUL = item.parent();\n        // The items in the currently active menu.\n        var menuItems = itemUL.children('li').not('.separator');\n        // The items index in its menu.\n        var menuIndex = menuItems.index(item);\n        var newItem = null;\n\n        if (itemUL.is('.tool-lp-menu')) {\n            // This is the root level menu.\n            // Nothing to do.\n            return item;\n        }\n\n        // If item is not the first item in its menu, move to the previous item.\n        if (menuIndex > 0) {\n            newItem = menuItems.eq(menuIndex - 1);\n        } else {\n            // Loop to top of menu.\n            newItem = menuItems.last();\n        }\n\n        // Remove the focus styling from the current item.\n        item.removeClass('menu-focus');\n\n        return newItem;\n    };\n\n    /**\n     * Enhance the dom with aria attributes.\n     * @method addAriaAttributes\n     */\n    Menubar.prototype.addAriaAttributes = function() {\n        this.menuRoot.attr('role', 'menubar');\n        this.rootMenus.attr('role', 'menuitem');\n        this.rootMenus.attr('tabindex', '0');\n        this.rootMenus.attr('aria-haspopup', 'true');\n        this.subMenus.attr('role', 'menu');\n        this.subMenus.attr('aria-hidden', 'true');\n        this.subMenuItems.attr('role', 'menuitem');\n        this.subMenuItems.attr('tabindex', '-1');\n\n        // For CSS styling and effects.\n        this.menuRoot.addClass('tool-lp-menu');\n        this.allItems.addClass('tool-lp-menu-item');\n        this.rootMenus.addClass('tool-lp-root-menu');\n        this.subMenus.addClass('tool-lp-sub-menu');\n        this.subMenuItems.addClass('dropdown-item');\n    };\n\n    return /** @alias module:tool_lp/menubar */ {\n        /**\n         * Create a menu bar object for every node matching the selector.\n         *\n         * The expected DOM structure is shown below.\n         * <ul> <- This is the target of the selector parameter.\n         *   <li> <- This is repeated for each top level menu.\n         *      Text <- This is the text for the top level menu.\n         *      <ul> <- This is a list of the entries in this top level menu.\n         *         <li> <- This is repeated for each menu entry.\n         *            <a href=\"someurl\">Choice 1</a> <- The anchor for the menu.\n         *         </li>\n         *      </ul>\n         *   </li>\n         * </ul>\n         *\n         * @method enhance\n         * @param {String} selector - The selector for the outer most menu node.\n         * @param {Function} handler - Javascript handler for when a menu item was chosen. If the\n         *                             handler returns true (or does not exist), the\n         *                             menu will look for an anchor with a link to follow.\n         *                             For example, if the menu entry has a \"data-action\" attribute\n         *                             and we want to call a javascript function when that entry is chosen,\n         *                             we could pass a list of handlers like this:\n         *                             { \"[data-action='add']\" : callAddFunction }\n         */\n        enhance: function(selector, handler) {\n            $(selector).each(function(index, element) {\n                var menuRoot = $(element);\n                // Don't enhance the same menu twice.\n                if (menuRoot.data(\"menubarEnhanced\") !== true) {\n                    (new Menubar(menuRoot, handler));\n                    menuRoot.data(\"menubarEnhanced\", true);\n                }\n            });\n        },\n\n        /**\n         * Handy function to close all open menus anywhere on the page.\n         * @method closeAll\n         */\n        closeAll: closeAllSubMenus\n    };\n});\n"]}