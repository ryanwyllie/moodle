'use strict';define('tool_lp/course_competency_settings',['jquery','core/notification','tool_lp/dialogue','core/str','core/ajax','core/templates'],function($,notification,Dialogue,str,ajax,templates){var settingsMod=function(selector){$(selector).on('click',this.configureSettings.bind(this))};return settingsMod.prototype._dialogue=null,settingsMod.prototype.configureSettings=function(e){var courseid=$(e.target).closest('a').data('courseid'),currentValue=$(e.target).closest('a').data('pushratingstouserplans');e.preventDefault(),templates.render('tool_lp/course_competency_settings',{courseid:courseid,settings:{pushratingstouserplans:currentValue}}).done(function(html){str.get_string('configurecoursecompetencysettings','tool_lp').done(function(title){this._dialogue=new Dialogue(title,html,this.addListeners.bind(this))}.bind(this)).fail(notification.exception)}.bind(this)).fail(notification.exception)},settingsMod.prototype.addListeners=function(){var save=this._find('[data-action="save"]');save.on('click',this.saveSettings.bind(this));var cancel=this._find('[data-action="cancel"]');cancel.on('click',this.cancelChanges.bind(this))},settingsMod.prototype.cancelChanges=function(e){e.preventDefault(),this._dialogue.close()},settingsMod.prototype._find=function(selector){return $('[data-region="coursecompetencysettings"]').find(selector)},settingsMod.prototype.saveSettings=function(e){e.preventDefault();var newValue=this._find('input[name="pushratingstouserplans"]:checked').val(),courseId=this._find('input[name="courseid"]').val();ajax.call([{methodname:'core_competency_update_course_competency_settings',args:{courseid:courseId,settings:{pushratingstouserplans:newValue}}}])[0].done(function(){this.refreshCourseCompetenciesPage()}.bind(this)).fail(notification.exception)},settingsMod.prototype.refreshCourseCompetenciesPage=function(){var courseId=this._find('input[name="courseid"]').val();ajax.call([{methodname:'tool_lp_data_for_course_competencies_page',args:{courseid:courseId}}])[0].done(function(context){templates.render('tool_lp/course_competencies_page',context).done(function(html,js){$('[data-region="coursecompetenciespage"]').replaceWith(html),templates.runTemplateJS(js),this._dialogue.close()}.bind(this)).fail(notification.exception)}.bind(this)).fail(notification.exception)},settingsMod});
//# sourceMappingURL=course_competency_settings.min.js.map
