'use strict';define('tool_lp/grade_user_competency_inline',['jquery','core/notification','core/ajax','core/log','tool_lp/grade_dialogue','tool_lp/event_base','tool_lp/scalevalues'],function($,notification,ajax,log,GradeDialogue,EventBase,ScaleValues){var InlineEditor=function(selector,scaleId,competencyId,userId,planId,courseId,chooseStr){EventBase.prototype.constructor.apply(this,[]);var trigger=$(selector);if(!trigger.length)throw new Error('Could not find the trigger');this._scaleId=scaleId,this._competencyId=competencyId,this._userId=userId,this._planId=planId,this._courseId=courseId,this._chooseStr=chooseStr,this._setUp(),trigger.click(function(e){e.preventDefault(),this._dialogue.display()}.bind(this)),this._planId?(this._methodName='core_competency_grade_competency_in_plan',this._args={competencyid:this._competencyId,planid:this._planId}):this._courseId?(this._methodName='core_competency_grade_competency_in_course',this._args={competencyid:this._competencyId,courseid:this._courseId,userid:this._userId}):(this._methodName='core_competency_grade_competency',this._args={userid:this._userId,competencyid:this._competencyId})};return InlineEditor.prototype=Object.create(EventBase.prototype),InlineEditor.prototype._setUp=function(){var options=[],self=this,promise=ScaleValues.get_values(self._scaleId);promise.done(function(scalevalues){options.push({value:'',name:self._chooseStr});for(var optionConfig,i=0;i<scalevalues.length;i++)optionConfig=scalevalues[i],options.push({value:optionConfig.id,name:optionConfig.name});self._dialogue=new GradeDialogue(options),self._dialogue.on('rated',function(e,data){var args=self._args;args.grade=data.rating,args.note=data.note,ajax.call([{methodname:self._methodName,args:args,done:function done(evidence){self._trigger('competencyupdated',{args:args,evidence:evidence})},fail:notification.exception}])})}).fail(notification.exception)},InlineEditor.prototype._scaleId=null,InlineEditor.prototype._competencyId=null,InlineEditor.prototype._userId=null,InlineEditor.prototype._planId=null,InlineEditor.prototype._courseId=null,InlineEditor.prototype._chooseStr=null,InlineEditor.prototype._dialogue=null,InlineEditor});
//# sourceMappingURL=grade_user_competency_inline.min.js.map
