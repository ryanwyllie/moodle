define("core_calendar/month_view_drag_drop",["jquery","core/notification","core/str","core_calendar/events","core_calendar/drag_drop_data_store"],function(a,b,c,d,f){var g={ROOT:"[data-region='calendar']",DRAGGABLE:"[draggable=\"true\"][data-region=\"event-item\"]",DROP_ZONE:"[data-drop-zone=\"month-view-day\"]",WEEK:"[data-region=\"month-view-week\"]"},e="bg-faded",h="bg-danger text-white",i="bg-primary text-white",j=e+" "+h+" "+i,k=!1,l=function(b){var c=a(b.target).closest(g.DROP_ZONE);return c.length?c:null},m=function(a){var b=a.attr("data-day-timestamp"),c=f.getMinTimestart(),d=f.getMaxTimestart();if(c&&c>b){return!1}if(d&&d<b){return!1}return!0},n=function(a){var b=a.attr("data-day-timestamp"),c=f.getMinTimestart(),d=f.getMaxTimestart();if(c&&c>b){return f.getMinError()}if(d&&d<b){return f.getMaxError()}return null},o=function(){a(g.ROOT).find(g.DROP_ZONE).each(function(b,c){c=a(c);c.removeClass(j)})},p=function(a,b,c){if("undefined"==typeof c){c=f.getDurationDays()}var d=m(a);a.removeClass(j);if(b){if(d){a.addClass(i)}else{a.addClass(h)}}else{a.removeClass(i+" "+h);if(!d){a.addClass(e)}}c--;if(0<c){var k=a.next();if(!k.length){var l=a.closest(g.WEEK).next();if(l.length){k=l.children(g.DROP_ZONE).first()}}if(k.length){p(k,b,c)}}},q=function(){a(g.ROOT).find(g.DROP_ZONE).each(function(b,c){c=a(c);if(!m(c)){p(c,!1)}})},r=function(b){var c=a(b.target),d=c.closest(g.DRAGGABLE);if(!d.length){return}var e=d.find("[data-event-id]"),h=e.attr("data-event-id"),i=d.attr("data-min-day-timestamp"),j=d.attr("data-max-day-timestamp"),k=d.attr("data-min-day-error"),l=d.attr("data-max-day-error"),m=g.ROOT+" [data-event-id=\""+h+"\"]",n=a(m).length;f.setEventId(h);f.setDurationDays(n);if(i){f.setMinTimestart(i)}if(j){f.setMaxTimestart(j)}if(k){f.setMinError(k)}if(l){f.setMaxError(l)}b.dataTransfer.effectAllowed="move";b.dataTransfer.dropEffect="move";b.dataTransfer.setData("text/plain",h);b.dropEffect="move";q()},s=function(a){if(!f.hasEventId()){return}a.preventDefault();var b=l(a);if(!b){return}p(b,!0)},t=function(a){if(!f.hasEventId()){return}var b=l(a);if(!b){return}p(b,!1);a.preventDefault()},u=function(h){if(!f.hasEventId()){return}var e=l(h);if(!e){f.clearAll();o();return}if(m(e)){var i=f.getEventId(),j=g.ROOT+" [data-event-id=\""+i+"\"]",k=a(j),p=null;if(k.length){p=k.closest(g.DROP_ZONE)}a("body").trigger(d.moveEvent,[i,p,e])}else{var q=n(e);c.get_string("errorinvaliddate","calendar").then(function(a){b.exception({name:a,message:q||a})})}f.clearAll();o();h.preventDefault()},v=function(){f.clearAll();o()},w=function(){q()};return{init:function init(){if(!k){document.addEventListener("dragstart",r,!1);document.addEventListener("dragover",s,!1);document.addEventListener("dragleave",t,!1);document.addEventListener("drop",u,!1);document.addEventListener("dragend",v,!1);a("body").on(d.monthChanged,w);k=!0}}}});
//# sourceMappingURL=month_view_drag_drop.min.js.map
