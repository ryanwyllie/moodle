'use strict';define('core_calendar/calendar_view',['jquery','core/str','core/notification','core_calendar/selectors','core_calendar/events','core_calendar/view_manager','core_calendar/repository','core/modal_factory','core_calendar/modal_event_form','core/modal_events','core_calendar/crud'],function($,Str,Notification,CalendarSelectors,CalendarEvents,CalendarViewManager,CalendarRepository,ModalFactory,ModalEventForm,ModalEvents,CalendarCrud){var registerEventListeners=function(root,type){var body=$('body');CalendarCrud.registerRemove(root);var reloadFunction='reloadCurrent'+type.charAt(0).toUpperCase()+type.slice(1);body.on(CalendarEvents.created,function(){CalendarViewManager[reloadFunction](root)}),body.on(CalendarEvents.deleted,function(){CalendarViewManager[reloadFunction](root)}),body.on(CalendarEvents.updated,function(){CalendarViewManager[reloadFunction](root)}),root.on('change',CalendarSelectors.courseSelector,function(){var selectElement=$(this),courseId=selectElement.val();CalendarViewManager[reloadFunction](root,courseId,null).then(function(){return root.find(CalendarSelectors.courseSelector).val(courseId)}).then(function(){window.history.pushState({},'','?view=upcoming&course='+courseId)}).fail(Notification.exception)}),body.on(CalendarEvents.filterChanged,function(e,data){var daysWithEvent=root.find(CalendarSelectors.eventType[data.type]);!0==data.hidden?daysWithEvent.addClass('hidden'):daysWithEvent.removeClass('hidden')});var eventFormPromise=CalendarCrud.registerEventFormModal(root);CalendarCrud.registerEditListeners(root,eventFormPromise)};return{init:function init(root,type){root=$(root),CalendarViewManager.init(root,type),registerEventListeners(root,type)}}});
//# sourceMappingURL=calendar_view.min.js.map
