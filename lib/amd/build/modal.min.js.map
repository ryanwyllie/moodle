{"version":3,"sources":["../src/modal.js"],"names":["define","$","Templates","Notification","KeyCodes","CustomEvents","ModalBackdrop","Event","ModalEvents","backdropPromise","SELECTORS","CONTAINER","MODAL","HEADER","TITLE","BODY","FOOTER","HIDE","DIALOG","MENU_BAR","HAS_Z_INDEX","CAN_RECEIVE_FOCUS","TEMPLATES","LOADING","BACKDROP","modalCounter","Modal","root","modal","find","header","title","body","footer","hiddenSiblings","isAttached","bodyJS","footerJS","modalCount","is","exception","message","length","registerEventListeners","prototype","attachToDOM","append","runTemplateJS","countOtherVisibleModals","count","each","index","element","hasClass","bind","getBackdrop","render","then","html","fail","getRoot","getModal","getTitle","getBody","getFooter","getModalCount","setTitle","value","asyncSet","setBody","notifyFilterContentUpdated","trigger","bodyRendered","jsPendingId","M","util","js_pending","contentPromise","css","state","height","innerHeight","animate","loadingIcon","hide","fadeIn","when","promise","fadeOut","js","result","isVisible","currentHeight","newHeight","opacity","duration","queue","always","js_complete","setFooter","showFooter","done","hasFooterContent","children","hideFooter","addClass","removeClass","setLarge","isLarge","setSmall","isSmall","calculateZIndex","items","zIndex","parseInt","item","itemZIndex","hasFocus","target","document","activeElement","has","hasTransitions","show","backdrop","currentIndex","newIndex","setZIndex","accessibilityShow","focus","shown","accessibilityHide","one","hidden","destroy","remove","destroyed","child","attr","data","push","sibling","previousValue","removeAttr","handleTabLock","e","focusableElements","firstFocusable","first","lastFocusable","last","shiftKey","preventDefault","on","keyCode","tab","escape","click","closest","events","activate","originalEvent","setFunction","p","hasOwnProperty","Deferred","resolve","content"],"mappings":"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","file":"modal.min.js","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Contain the logic for modals.\n *\n * @module     core/modal\n * @class      modal\n * @package    core\n * @copyright  2016 Ryan Wyllie <ryan@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/templates', 'core/notification', 'core/key_codes',\n        'core/custom_interaction_events', 'core/modal_backdrop', 'core/event', 'core/modal_events'],\n     function($, Templates, Notification, KeyCodes, CustomEvents, ModalBackdrop, Event, ModalEvents) {\n\n    var SELECTORS = {\n        CONTAINER: '[data-region=\"modal-container\"]',\n        MODAL: '[data-region=\"modal\"]',\n        HEADER: '[data-region=\"header\"]',\n        TITLE: '[data-region=\"title\"]',\n        BODY: '[data-region=\"body\"]',\n        FOOTER: '[data-region=\"footer\"]',\n        HIDE: '[data-action=\"hide\"]',\n        DIALOG: '[role=dialog]',\n        MENU_BAR: '[role=menubar]',\n        HAS_Z_INDEX: '.moodle-has-zindex',\n        CAN_RECEIVE_FOCUS: 'input:not([type=\"hidden\"]), a[href], button, textarea, select, [tabindex]',\n    };\n\n    var TEMPLATES = {\n        LOADING: 'core/loading',\n        BACKDROP: 'core/modal_backdrop',\n    };\n\n    /**\n     * Module singleton for the backdrop to be reused by all Modal instances.\n     */\n    var backdropPromise;\n\n    /**\n     * A counter that gets incremented for each modal created. This can be\n     * used to generate unique values for the modals.\n     */\n    var modalCounter = 0;\n\n    /**\n     * Constructor for the Modal.\n     *\n     * @param {object} root The root jQuery element for the modal\n     */\n    var Modal = function(root) {\n        this.root = $(root);\n        this.modal = this.root.find(SELECTORS.MODAL);\n        this.header = this.modal.find(SELECTORS.HEADER);\n        this.title = this.header.find(SELECTORS.TITLE);\n        this.body = this.modal.find(SELECTORS.BODY);\n        this.footer = this.modal.find(SELECTORS.FOOTER);\n        this.hiddenSiblings = [];\n        this.isAttached = false;\n        this.bodyJS = null;\n        this.footerJS = null;\n        this.modalCount = modalCounter++;\n\n        if (!this.root.is(SELECTORS.CONTAINER)) {\n            Notification.exception({message: 'Element is not a modal container'});\n        }\n\n        if (!this.modal.length) {\n            Notification.exception({message: 'Container does not contain a modal'});\n        }\n\n        if (!this.header.length) {\n            Notification.exception({message: 'Modal is missing a header region'});\n        }\n\n        if (!this.title.length) {\n            Notification.exception({message: 'Modal header is missing a title region'});\n        }\n\n        if (!this.body.length) {\n            Notification.exception({message: 'Modal is missing a body region'});\n        }\n\n        if (!this.footer.length) {\n            Notification.exception({message: 'Modal is missing a footer region'});\n        }\n\n        this.registerEventListeners();\n    };\n\n    /**\n     * Add the modal to the page, if it hasn't already been added. This includes running any\n     * javascript that has been cached until now.\n     *\n     * @method attachToDOM\n     */\n    Modal.prototype.attachToDOM = function() {\n        if (this.isAttached) {\n            return;\n        }\n\n        $('body').append(this.root);\n\n        // If we'd cached any JS then we can run it how that the modal is\n        // attached to the DOM.\n        if (this.bodyJS) {\n            Templates.runTemplateJS(this.bodyJS);\n            this.bodyJS = null;\n        }\n\n        if (this.footerJS) {\n            Templates.runTemplateJS(this.footerJS);\n            this.footerJS = null;\n        }\n\n        this.isAttached = true;\n    };\n\n    /**\n     * Count the number of other visible modals (not including this one).\n     *\n     * @method countOtherVisibleModals\n     * @return {int}\n     */\n    Modal.prototype.countOtherVisibleModals = function() {\n        var count = 0;\n        $('body').find(SELECTORS.CONTAINER).each(function(index, element) {\n            element = $(element);\n\n            // If we haven't found ourself and the element is visible.\n            if (!this.root.is(element) && element.hasClass('show')) {\n                count++;\n            }\n        }.bind(this));\n\n        return count;\n    };\n\n    /**\n     * Get the modal backdrop.\n     *\n     * @method getBackdrop\n     * @return {object} jQuery promise\n     */\n    Modal.prototype.getBackdrop = function() {\n        if (!backdropPromise) {\n            backdropPromise = Templates.render(TEMPLATES.BACKDROP, {})\n                .then(function(html) {\n                    var element = $(html);\n\n                    return new ModalBackdrop(element);\n                })\n                .fail(Notification.exception);\n        }\n\n        return backdropPromise;\n    };\n\n    /**\n     * Get the root element of this modal.\n     *\n     * @method getRoot\n     * @return {object} jQuery object\n     */\n    Modal.prototype.getRoot = function() {\n        return this.root;\n    };\n\n    /**\n     * Get the modal element of this modal.\n     *\n     * @method getModal\n     * @return {object} jQuery object\n     */\n    Modal.prototype.getModal = function() {\n        return this.modal;\n    };\n\n    /**\n     * Get the modal title element.\n     *\n     * @method getTitle\n     * @return {object} jQuery object\n     */\n    Modal.prototype.getTitle = function() {\n        return this.title;\n    };\n\n    /**\n     * Get the modal body element.\n     *\n     * @method getBody\n     * @return {object} jQuery object\n     */\n    Modal.prototype.getBody = function() {\n        return this.body;\n    };\n\n    /**\n     * Get the modal footer element.\n     *\n     * @method getFooter\n     * @return {object} jQuery object\n     */\n    Modal.prototype.getFooter = function() {\n        return this.footer;\n    };\n\n    /**\n     * Get the unique modal count.\n     *\n     * @method getModalCount\n     * @return {int}\n     */\n    Modal.prototype.getModalCount = function() {\n        return this.modalCount;\n    };\n\n    /**\n     * Set the modal title element.\n     *\n     * This method is overloaded to take either a string value for the title or a jQuery promise that is resolved with\n     * HTML most commonly from a Str.get_string call.\n     *\n     * @method setTitle\n     * @param {(string|object)} value The title string or jQuery promise which resolves to the title.\n     */\n    Modal.prototype.setTitle = function(value) {\n        var title = this.getTitle();\n\n        this.asyncSet(value, title.html.bind(title));\n    };\n\n    /**\n     * Set the modal body element.\n     *\n     * This method is overloaded to take either a string value for the body or a jQuery promise that is resolved with\n     * HTML and Javascript most commonly from a Templates.render call.\n     *\n     * @method setBody\n     * @param {(string|object)} value The body string or jQuery promise which resolves to the body.\n     */\n    Modal.prototype.setBody = function(value) {\n        var body = this.getBody();\n\n        if (typeof value === 'string') {\n            // Just set the value if it's a string.\n            body.html(value);\n            Event.notifyFilterContentUpdated(body);\n            this.getRoot().trigger(ModalEvents.bodyRendered, this);\n        } else {\n            var jsPendingId = 'amd-modal-js-pending-id-' + this.getModalCount();\n            M.util.js_pending(jsPendingId);\n            // Otherwise we assume it's a promise to be resolved with\n            // html and javascript.\n            var contentPromise = null;\n            body.css('overflow', 'hidden');\n\n            if (value.state() == 'pending') {\n                // We're still waiting for the body promise to resolve so\n                // let's show a loading icon.\n                var height = body.innerHeight();\n                if (height < 100) {\n                    height = 100;\n                }\n\n                body.animate({height: height + 'px'}, 150);\n\n                body.html('');\n                contentPromise = Templates.render(TEMPLATES.LOADING, {})\n                    .then(function(html) {\n                        var loadingIcon = $(html).hide();\n                        body.html(loadingIcon);\n                        loadingIcon.fadeIn(150);\n\n                        // We only want the loading icon to fade out\n                        // when the content for the body has finished\n                        // loading.\n                        return $.when(loadingIcon.promise(), value);\n                    })\n                    .then(function(loadingIcon) {\n                        // Once the content has finished loading and\n                        // the loading icon has been shown then we can\n                        // fade the icon away to reveal the content.\n                        return loadingIcon.fadeOut(100).promise();\n                    })\n                    .then(function() {\n                        return value;\n                    });\n            } else {\n                // The content is already loaded so let's just display\n                // it to the user. No need for a loading icon.\n                contentPromise = value;\n            }\n\n            // Now we can actually display the content.\n            contentPromise.then(function(html, js) {\n                var result = null;\n\n                if (this.isVisible()) {\n                    // If the modal is visible then we should display\n                    // the content gracefully for the user.\n                    body.css('opacity', 0);\n                    var currentHeight = body.innerHeight();\n                    body.html(html);\n                    // We need to clear any height values we've set here\n                    // in order to measure the height of the content being\n                    // added. This then allows us to animate the height\n                    // transition.\n                    body.css('height', '');\n                    var newHeight = body.innerHeight();\n                    body.css('height', currentHeight + 'px');\n                    result = body.animate(\n                        {height: newHeight + 'px', opacity: 1},\n                        {duration: 150, queue: false}\n                    ).promise();\n                } else {\n                    // Since the modal isn't visible we can just immediately\n                    // set the content. No need to animate it.\n                    body.html(html);\n                }\n\n                if (js) {\n                    if (this.isAttached) {\n                        // If we're in the DOM then run the JS immediately.\n                        Templates.runTemplateJS(js);\n                    } else {\n                        // Otherwise cache it to be run when we're attached.\n                        this.bodyJS = js;\n                    }\n                }\n                Event.notifyFilterContentUpdated(body);\n                this.getRoot().trigger(ModalEvents.bodyRendered, this);\n\n                return result;\n            }.bind(this))\n            .fail(Notification.exception)\n            .always(function() {\n                // When we're done displaying all of the content we need\n                // to clear the custom values we've set here.\n                body.css('height', '');\n                body.css('overflow', '');\n                body.css('opacity', '');\n                M.util.js_complete(jsPendingId);\n\n                return;\n            })\n            .fail(Notification.exception);\n        }\n    };\n\n    /**\n     * Set the modal footer element. The footer element is made visible, if it\n     * isn't already.\n     *\n     * This method is overloaded to take either a string\n     * value for the body or a jQuery promise that is resolved with HTML and Javascript\n     * most commonly from a Templates.render call.\n     *\n     * @method setFooter\n     * @param {(string|object)} value The footer string or jQuery promise\n     */\n    Modal.prototype.setFooter = function(value) {\n        // Make sure the footer is visible.\n        this.showFooter();\n\n        var footer = this.getFooter();\n\n        if (typeof value === 'string') {\n            // Just set the value if it's a string.\n            footer.html(value);\n        } else {\n            // Otherwise we assume it's a promise to be resolved with\n            // html and javascript.\n            Templates.render(TEMPLATES.LOADING, {}).done(function(html) {\n                footer.html(html);\n\n                value.done(function(html, js) {\n                    footer.html(html);\n\n                    if (js) {\n                        if (this.isAttached) {\n                            // If we're in the DOM then run the JS immediately.\n                            Templates.runTemplateJS(js);\n                        } else {\n                            // Otherwise cache it to be run when we're attached.\n                            this.footerJS = js;\n                        }\n                    }\n                }.bind(this));\n            }.bind(this));\n        }\n    };\n\n    /**\n     * Check if the footer has any content in it.\n     *\n     * @method hasFooterContent\n     * @return {bool}\n     */\n    Modal.prototype.hasFooterContent = function() {\n        return this.getFooter().children().length ? true : false;\n    };\n\n    /**\n     * Hide the footer element.\n     *\n     * @method hideFooter\n     */\n    Modal.prototype.hideFooter = function() {\n        this.getFooter().addClass('hidden');\n    };\n\n    /**\n     * Show the footer element.\n     *\n     * @method showFooter\n     */\n    Modal.prototype.showFooter = function() {\n        this.getFooter().removeClass('hidden');\n    };\n\n    /**\n     * Mark the modal as a large modal.\n     *\n     * @method setLarge\n     */\n    Modal.prototype.setLarge = function() {\n        if (this.isLarge()) {\n            return;\n        }\n\n        this.getModal().addClass('modal-lg');\n    };\n\n    /**\n     * Check if the modal is a large modal.\n     *\n     * @method isLarge\n     * @return {bool}\n     */\n    Modal.prototype.isLarge = function() {\n        return this.getModal().hasClass('modal-lg');\n    };\n\n    /**\n     * Mark the modal as a small modal.\n     *\n     * @method setSmall\n     */\n    Modal.prototype.setSmall = function() {\n        if (this.isSmall()) {\n            return;\n        }\n\n        this.getModal().removeClass('modal-lg');\n    };\n\n    /**\n     * Check if the modal is a small modal.\n     *\n     * @method isSmall\n     * @return {bool}\n     */\n    Modal.prototype.isSmall = function() {\n        return !this.getModal().hasClass('modal-lg');\n    };\n\n    /**\n     * Determine the highest z-index value currently on the page.\n     *\n     * @method calculateZIndex\n     * @return {int}\n     */\n    Modal.prototype.calculateZIndex = function() {\n        var items = $(SELECTORS.DIALOG + ', ' + SELECTORS.MENU_BAR + ', ' + SELECTORS.HAS_Z_INDEX);\n        var zIndex = parseInt(this.root.css('z-index'));\n\n        items.each(function(index, item) {\n            item = $(item);\n            // Note that webkit browsers won't return the z-index value from the CSS stylesheet\n            // if the element doesn't have a position specified. Instead it'll return \"auto\".\n            var itemZIndex = item.css('z-index') ? parseInt(item.css('z-index')) : 0;\n\n            if (itemZIndex > zIndex) {\n                zIndex = itemZIndex;\n            }\n        });\n\n        return zIndex;\n    };\n\n    /**\n     * Check if this modal is visible.\n     *\n     * @method isVisible\n     * @return {bool}\n     */\n    Modal.prototype.isVisible = function() {\n        return this.root.hasClass('show');\n    };\n\n    /**\n     * Check if this modal has focus.\n     *\n     * @method hasFocus\n     * @return {bool}\n     */\n    Modal.prototype.hasFocus = function() {\n        var target = $(document.activeElement);\n        return this.root.is(target) || this.root.has(target).length;\n    };\n\n    /**\n     * Check if this modal has CSS transitions applied.\n     *\n     * @method hasTransitions\n     * @return {bool}\n     */\n    Modal.prototype.hasTransitions = function() {\n        return this.getRoot().hasClass('fade');\n    };\n\n    /**\n     * Display this modal. The modal will be attached to the DOM if it hasn't\n     * already been.\n     *\n     * @method show\n     */\n    Modal.prototype.show = function() {\n        if (this.isVisible()) {\n            return;\n        }\n\n        if (this.hasFooterContent()) {\n            this.showFooter();\n        } else {\n            this.hideFooter();\n        }\n\n        if (!this.isAttached) {\n            this.attachToDOM();\n        }\n\n        this.getBackdrop().done(function(backdrop) {\n            var currentIndex = this.calculateZIndex();\n            var newIndex = currentIndex + 2;\n            var newBackdropIndex = newIndex - 1;\n            this.root.css('z-index', newIndex);\n            backdrop.setZIndex(newBackdropIndex);\n            backdrop.show();\n\n            this.root.removeClass('hide').addClass('show');\n            this.accessibilityShow();\n            this.getModal().focus();\n            $('body').addClass('modal-open');\n            this.root.trigger(ModalEvents.shown, this);\n        }.bind(this));\n    };\n\n    /**\n     * Hide this modal.\n     *\n     * @method hide\n     */\n    Modal.prototype.hide = function() {\n        if (!this.isVisible()) {\n            return;\n        }\n\n        this.getBackdrop().done(function(backdrop) {\n            if (!this.countOtherVisibleModals()) {\n                // Hide the backdrop if we're the last open modal.\n                backdrop.hide();\n                $('body').removeClass('modal-open');\n            }\n\n            var currentIndex = parseInt(this.root.css('z-index'));\n            this.root.css('z-index', '');\n            backdrop.setZIndex(currentIndex - 3);\n\n            this.accessibilityHide();\n\n            if (this.hasTransitions()) {\n                // Wait for CSS transitions to complete before hiding the element.\n                this.getRoot().one('transitionend webkitTransitionEnd oTransitionEnd', function() {\n                    this.getRoot().removeClass('show').addClass('hide');\n                }.bind(this));\n            } else {\n                this.getRoot().removeClass('show').addClass('hide');\n            }\n\n            this.root.trigger(ModalEvents.hidden, this);\n        }.bind(this));\n    };\n\n    /**\n     * Remove this modal from the DOM.\n     *\n     * @method destroy\n     */\n    Modal.prototype.destroy = function() {\n        this.root.remove();\n        this.root.trigger(ModalEvents.destroyed, this);\n    };\n\n    /**\n     * Sets the appropriate aria attributes on this dialogue and the other\n     * elements in the DOM to ensure that screen readers are able to navigate\n     * the dialogue popup correctly.\n     *\n     * @method accessibilityShow\n     */\n    Modal.prototype.accessibilityShow = function() {\n        // We need to get a list containing each sibling element and the shallowest\n        // non-ancestral nodes in the DOM. We can shortcut this a little by leveraging\n        // the fact that this dialogue is always appended to the document body therefore\n        // it's siblings are the shallowest non-ancestral nodes. If that changes then\n        // this code should also be updated.\n        $('body').children().each(function(index, child) {\n            // Skip the current modal.\n            if (!this.root.is(child)) {\n                child = $(child);\n                var hidden = child.attr('aria-hidden');\n                // If they are already hidden we can ignore them.\n                if (hidden !== 'true') {\n                    // Save their current state.\n                    child.data('previous-aria-hidden', hidden);\n                    this.hiddenSiblings.push(child);\n\n                    // Hide this node from screen readers.\n                    child.attr('aria-hidden', 'true');\n                }\n            }\n        }.bind(this));\n\n        // Make us visible to screen readers.\n        this.root.attr('aria-hidden', 'false');\n    };\n\n    /**\n     * Restores the aria visibility on the DOM elements changed when displaying\n     * the dialogue popup and makes the dialogue aria hidden to allow screen\n     * readers to navigate the main page correctly when the dialogue is closed.\n     *\n     * @method accessibilityHide\n     */\n    Modal.prototype.accessibilityHide = function() {\n        this.root.attr('aria-hidden', 'true');\n\n        // Restore the sibling nodes back to their original values.\n        $.each(this.hiddenSiblings, function(index, sibling) {\n            sibling = $(sibling);\n            var previousValue = sibling.data('previous-aria-hidden');\n            // If the element didn't previously have an aria-hidden attribute\n            // then we can just remove the one we set.\n            if (typeof previousValue == 'undefined') {\n                sibling.removeAttr('aria-hidden');\n            } else {\n                // Otherwise set it back to the old value (which will be false).\n                sibling.attr('aria-hidden', previousValue);\n            }\n        });\n\n        // Clear the cache. No longer need to store these.\n        this.hiddenSiblings = [];\n    };\n\n    /**\n     * Handle the tab event to lock focus within this modal.\n     *\n     * @method handleTabLock\n     * @param {event} e The tab key jQuery event\n     */\n    Modal.prototype.handleTabLock = function(e) {\n        if (!this.hasFocus()) {\n            return;\n        }\n\n        var target = $(document.activeElement);\n        var focusableElements = this.modal.find(SELECTORS.CAN_RECEIVE_FOCUS);\n        var firstFocusable = focusableElements.first();\n        var lastFocusable = focusableElements.last();\n\n        if (target.is(firstFocusable) && e.shiftKey) {\n            lastFocusable.focus();\n            e.preventDefault();\n        } else if (target.is(lastFocusable) && !e.shiftKey) {\n            firstFocusable.focus();\n            e.preventDefault();\n        }\n    };\n\n    /**\n     * Set up all of the event handling for the modal.\n     *\n     * @method registerEventListeners\n     */\n    Modal.prototype.registerEventListeners = function() {\n        this.getRoot().on('keydown', function(e) {\n            if (!this.isVisible()) {\n                return;\n            }\n\n            if (e.keyCode == KeyCodes.tab) {\n                this.handleTabLock(e);\n            } else if (e.keyCode == KeyCodes.escape) {\n                this.hide();\n            }\n        }.bind(this));\n\n        // Listen for clicks on the modal container.\n        this.getRoot().click(function(e) {\n            // If the click wasn't inside the modal element then we should\n            // hide the modal.\n            if (!$(e.target).closest(SELECTORS.MODAL).length) {\n                this.hide();\n            }\n        }.bind(this));\n\n        CustomEvents.define(this.getModal(), [CustomEvents.events.activate]);\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.HIDE, function(e, data) {\n            this.hide();\n            data.originalEvent.preventDefault();\n        }.bind(this));\n    };\n\n    /**\n     * Set or resolve and set the value using the function.\n     *\n     * @method asyncSet\n     * @param {(string|object)} value The string or jQuery promise.\n     * @param {function} setFunction The setter\n     * @return {Promise}\n     */\n    Modal.prototype.asyncSet = function(value, setFunction) {\n        var p = value;\n        if (typeof value !== 'object' || !value.hasOwnProperty('then')) {\n            p = $.Deferred();\n            p.resolve(value);\n        }\n\n        p.then(function(content) {\n            setFunction(content);\n\n            return;\n        })\n        .fail(Notification.exception);\n\n        return p;\n    };\n\n    return Modal;\n});\n"]}