{"version":3,"sources":["../src/tag.js"],"names":["define","$","ajax","templates","notification","str","Y","initTagindexPage","delegate","e","preventDefault","target","query","search","replace","tagarea","closest","args","split","reduce","s","c","t","decodeURIComponent","promises","call","methodname","tagindex","when","apply","done","data","render","html","replaceWith","initManagePage","on","get_string","ajaxreturn","value","then","itemid","fail","exception","find","itemtype","row","removeClass","addClass","href","attr","get_strings","key","component","confirm","window","location","click","form","get","cnt","length","tempElement","name","appendTo","submit","tags","alert","el","fldset","each","tagid","val","tagname","append","use","panel","M","core","dialogue","draggable","modal","closeButton","headerContent","bodyContent","show","first","focus","prop","destroy","maintag","newvalue","errorcode","message","encodeURIComponent","cfg","sesskey","initManageCollectionsPage","areaid","collid","isenabled","hide","searchable","param"],"mappings":"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","file":"tag.min.js","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AJAX helper for the tag management page.\n *\n * @module     core/tag\n * @package    core_tag\n * @copyright  2015 Marina Glancy\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.0\n */\ndefine(['jquery', 'core/ajax', 'core/templates', 'core/notification', 'core/str', 'core/yui'],\n        function($, ajax, templates, notification, str, Y) {\n    return /** @alias module:core/tag */ {\n\n        /**\n         * Initialises tag index page.\n         *\n         * @method initTagindexPage\n         */\n        initTagindexPage: function() {\n            // Click handler for changing tag type.\n            $('body').delegate('.tagarea[data-ta] a[data-quickload=1]', 'click', function(e) {\n                e.preventDefault();\n                var target = $(this),\n                    query = target[0].search.replace(/^\\?/, ''),\n                    tagarea = target.closest('.tagarea[data-ta]'),\n                    args = query.split('&').reduce(function(s, c) {\n                      var t = c.split('=');\n                      s[t[0]] = decodeURIComponent(t[1]);\n                      return s;\n                    }, {});\n\n                var promises = ajax.call([{\n                    methodname: 'core_tag_get_tagindex',\n                    args: {tagindex: args}\n                }], true);\n\n                $.when.apply($, promises)\n                    .done(function(data) {\n                        templates.render('core_tag/index', data).done(function(html) {\n                            tagarea.replaceWith(html);\n                        });\n                    });\n            });\n        },\n\n        /**\n         * Initialises tag management page.\n         *\n         * @method initManagePage\n         */\n        initManagePage: function() {\n\n            // Set cell 'time modified' to 'now' when any of the element is updated in this row.\n            $('body').on('updated', '[data-inplaceeditable]', function(e) {\n                str.get_string('selecttag', 'core_tag', e.ajaxreturn.value)\n                    .then(function(s) {\n                        return $('label[for=\"tagselect' + e.ajaxreturn.itemid + '\"]').html(s);\n                    })\n                    .fail(notification.exception);\n                str.get_string('now').done(function(s) {\n                    $(e.target).closest('tr').find('td.col-timemodified').html(s);\n                });\n                if (e.ajaxreturn.itemtype === 'tagflag') {\n                    var row = $(e.target).closest('tr');\n                    if (e.ajaxreturn.value === '0') {\n                        row.removeClass('flagged-tag');\n                    } else {\n                        row.addClass('flagged-tag');\n                    }\n                }\n            });\n\n            // Confirmation for single tag delete link.\n            $('.tag-management-table').delegate('a.tagdelete', 'click', function(e) {\n                e.preventDefault();\n                var href = $(this).attr('href');\n                str.get_strings([\n                        {key: 'delete'},\n                        {key: 'confirmdeletetag', component: 'tag'},\n                        {key: 'yes'},\n                        {key: 'no'},\n                    ]).done(function(s) {\n                        notification.confirm(s[0], s[1], s[2], s[3], function() {\n                            window.location.href = href;\n                        });\n                    }\n                );\n            });\n\n            // Confirmation for bulk tag delete button.\n            $(\"#tag-management-delete\").click(function(e) {\n                var form = $(this).closest('form').get(0),\n                    cnt = $(form).find(\"input[type=checkbox]:checked\").length;\n                if (!cnt) {\n                    return;\n                }\n                var tempElement = $(\"<input type='hidden'/>\").attr('name', this.name);\n                e.preventDefault();\n                str.get_strings([\n                        {key: 'delete'},\n                        {key: 'confirmdeletetags', component: 'tag'},\n                        {key: 'yes'},\n                        {key: 'no'},\n                    ]).done(function(s) {\n                        notification.confirm(s[0], s[1], s[2], s[3], function() {\n                            tempElement.appendTo(form);\n                            form.submit();\n                        });\n                    }\n                );\n            });\n\n            // Confirmation for bulk tag combine button.\n            $(\"#tag-management-combine\").click(function(e) {\n                e.preventDefault();\n                var form = $(this).closest('form').get(0),\n                    tags = $(form).find(\"input[type=checkbox]:checked\");\n                if (tags.length <= 1) {\n                    str.get_strings([\n                        {key: 'combineselected', component: 'tag'},\n                        {key: 'selectmultipletags', component: 'tag'},\n                        {key: 'ok'},\n                    ]).done(function(s) {\n                            notification.alert(s[0], s[1], s[2]);\n                        }\n                    );\n                    return;\n                }\n                var tempElement = $(\"<input type='hidden'/>\").attr('name', this.name);\n                str.get_strings([\n                    {key: 'combineselected', component: 'tag'},\n                    {key: 'selectmaintag', component: 'tag'},\n                    {key: 'continue'},\n                    {key: 'cancel'},\n                ]).done(function(s) {\n                    var el = $('<div><form id=\"combinetags_form\" class=\"form-inline\">' +\n                        '<p class=\"description\"></p><p class=\"options\"></p>' +\n                        '<p class=\"mdl-align\"><input type=\"submit\" class=\"btn btn-primary\" id=\"combinetags_submit\"/>' +\n                        '<input type=\"button\" class=\"btn btn-secondary\" id=\"combinetags_cancel\"/></p>' +\n                        '</form></div>');\n                    el.find('.description').html(s[1]);\n                    el.find('#combinetags_submit').attr('value', s[2]);\n                    el.find('#combinetags_cancel').attr('value', s[3]);\n                    var fldset = el.find('.options');\n                    tags.each(function() {\n                        var tagid = $(this).val(),\n                            tagname = $('.inplaceeditable[data-itemtype=tagname][data-itemid=' + tagid + ']').attr('data-value');\n                        fldset.append($('<input type=\"radio\" name=\"maintag\" id=\"combinetags_maintag_' + tagid + '\" value=\"' +\n                            tagid + '\"/><label for=\"combinetags_maintag_' + tagid + '\">' + tagname + '</label><br>'));\n                    });\n                    // TODO: MDL-57778 Convert to core/modal.\n                    Y.use('moodle-core-notification-dialogue', function() {\n                        var panel = new M.core.dialogue({\n                            draggable: true,\n                            modal: true,\n                            closeButton: true,\n                            headerContent: s[0],\n                            bodyContent: el.html()\n                        });\n                        panel.show();\n                        $('#combinetags_form input[type=radio]').first().focus().prop('checked', true);\n                        $('#combinetags_form #combinetags_cancel').on('click', function() {\n                            panel.destroy();\n                        });\n                        $('#combinetags_form').on('submit', function() {\n                            tempElement.appendTo(form);\n                            var maintag = $('input[name=maintag]:checked', '#combinetags_form').val();\n                            $(\"<input type='hidden'/>\").attr('name', 'maintag').attr('value', maintag).appendTo(form);\n                            form.submit();\n                            return false;\n                        });\n                    });\n                });\n            });\n\n            // When user changes tag name to some name that already exists suggest to combine the tags.\n            $('body').on('updatefailed', '[data-inplaceeditable][data-itemtype=tagname]', function(e) {\n                var exception = e.exception; // The exception object returned by the callback.\n                var newvalue = e.newvalue; // The value that user tried to udpated the element to.\n                var tagid = $(e.target).attr('data-itemid');\n                if (exception.errorcode === 'namesalreadybeeingused') {\n                    e.preventDefault(); // This will prevent default error dialogue.\n                    str.get_strings([\n                        {key: 'nameuseddocombine', component: 'tag'},\n                        {key: 'yes'},\n                        {key: 'cancel'},\n                    ]).done(function(s) {\n                        notification.confirm(e.message, s[0], s[1], s[2], function() {\n                            window.location.href = window.location.href + \"&newname=\" + encodeURIComponent(newvalue) +\n                                \"&tagid=\" + encodeURIComponent(tagid) +\n                                '&action=renamecombine&sesskey=' + M.cfg.sesskey;\n                        });\n                    });\n                }\n            });\n\n            // Form for adding standard tags.\n            $('body').on('click', 'a[data-action=addstandardtag]', function(e) {\n                e.preventDefault();\n                str.get_strings([\n                    {key: 'addotags', component: 'tag'},\n                    {key: 'inputstandardtags', component: 'tag'},\n                    {key: 'continue'},\n                    {key: 'cancel'},\n                ]).done(function(s) {\n                    var el = $('<div><form id=\"addtags_form\" class=\"form-inline\" method=\"POST\">' +\n                        '<input type=\"hidden\" name=\"action\" value=\"addstandardtag\"/>' +\n                        '<input type=\"hidden\" name=\"sesskey\" value=\"' + M.cfg.sesskey + '\"/>' +\n                        '<p><label for=\"id_tagslist\">' + s[1] + '</label>' +\n                        '<input type=\"text\" id=\"id_tagslist\" name=\"tagslist\"/></p>' +\n                        '<p class=\"mdl-align\"><input type=\"submit\" class=\"btn btn-primary\" id=\"addtags_submit\"/>' +\n                        '<input type=\"button\" class=\"btn btn-secondary\" id=\"addtags_cancel\"/></p>' +\n                        '</form></div>');\n                    el.find('#addtags_form').attr('action', window.location.href);\n                    el.find('#addtags_submit').attr('value', s[2]);\n                    el.find('#addtags_cancel').attr('value', s[3]);\n                    // TODO: MDL-57778 Convert to core/modal.\n                    Y.use('moodle-core-notification-dialogue', function() {\n                        var panel = new M.core.dialogue({\n                            draggable: true,\n                            modal: true,\n                            closeButton: true,\n                            headerContent: s[0],\n                            bodyContent: el.html()\n                        });\n                        panel.show();\n                        $('#addtags_form input[type=text]').focus();\n                        $('#addtags_form #addtags_cancel').on('click', function() {\n                            panel.destroy();\n                        });\n                    });\n                });\n            });\n        },\n\n        /**\n         * Initialises tag collection management page.\n         *\n         * @method initManageCollectionsPage\n         */\n        initManageCollectionsPage: function() {\n            $('body').on('updated', '[data-inplaceeditable]', function(e) {\n                var ajaxreturn = e.ajaxreturn,\n                    areaid, collid, isenabled;\n                if (ajaxreturn.component === 'core_tag' && ajaxreturn.itemtype === 'tagareaenable') {\n                    areaid = $(this).attr('data-itemid');\n                    $(\".tag-collections-table ul[data-collectionid] li[data-areaid=\" + areaid + \"]\").hide();\n                    isenabled = ajaxreturn.value;\n                    if (isenabled === '1') {\n                        $(this).closest('tr').removeClass('dimmed_text');\n                        collid = $(this).closest('tr').find('[data-itemtype=\"tagareacollection\"]').attr(\"data-value\");\n                        $(\".tag-collections-table ul[data-collectionid=\" + collid + \"] li[data-areaid=\" + areaid + \"]\").show();\n                    } else {\n                        $(this).closest('tr').addClass('dimmed_text');\n                    }\n                }\n                if (ajaxreturn.component === 'core_tag' && ajaxreturn.itemtype === 'tagareacollection') {\n                    areaid = $(this).attr('data-itemid');\n                    $(\".tag-collections-table ul[data-collectionid] li[data-areaid=\" + areaid + \"]\").hide();\n                    collid = $(this).attr('data-value');\n                    isenabled = $(this).closest('tr').find('[data-itemtype=\"tagareaenable\"]').attr(\"data-value\");\n                    if (isenabled === \"1\") {\n                        $(\".tag-collections-table ul[data-collectionid=\" + collid + \"] li[data-areaid=\" + areaid + \"]\").show();\n                    }\n                }\n            });\n\n            $('body').on('click', '.addtagcoll > a', function(e) {\n                e.preventDefault();\n                var href = $(this).attr('data-url') + '&sesskey=' + M.cfg.sesskey;\n                str.get_strings([\n                        {key: 'addtagcoll', component: 'tag'},\n                        {key: 'name'},\n                        {key: 'searchable', component: 'tag'},\n                        {key: 'create'},\n                        {key: 'cancel'},\n                    ]).done(function(s) {\n                        var el = $('<div><form id=\"addtagcoll_form\" class=\"form-inline\">' +\n                            '<p><label for=\"addtagcoll_name\"></label>: ' +\n                            '<input id=\"addtagcoll_name\" type=\"text\"/></p>' +\n                            '<p><label for=\"addtagcoll_searchable\"></label>: ' +\n                            '<input id=\"addtagcoll_searchable\" type=\"checkbox\" value=\"1\" checked/></p>' +\n                            '<p class=\"mdl-align\"><input type=\"submit\" class=\"btn btn-primary\" id=\"addtagcoll_submit\"/>' +\n                            '<input type=\"button\" class=\"btn btn-secondary\" id=\"addtagcoll_cancel\"/></p>' +\n                            '</form></div>');\n                        el.find('label[for=\"addtagcoll_name\"]').html(s[1]);\n                        el.find('label[for=\"addtagcoll_searchable\"]').html(s[2]);\n                        el.find('#addtagcoll_submit').attr('value', s[3]);\n                        el.find('#addtagcoll_cancel').attr('value', s[4]);\n                        // TODO: MDL-57778 Convert to core/modal.\n                        Y.use('moodle-core-notification-dialogue', function() {\n                            var panel = new M.core.dialogue({\n                                draggable: true,\n                                modal: true,\n                                closeButton: true,\n                                headerContent: s[0],\n                                bodyContent: el.html()\n                            });\n                            panel.show();\n                            $('#addtagcoll_form #addtagcoll_name').focus();\n                            $('#addtagcoll_form #addtagcoll_cancel').on('click', function() {\n                                panel.destroy();\n                            });\n                            $('#addtagcoll_form').on('submit', function() {\n                                var name = $('#addtagcoll_form #addtagcoll_name').val();\n                                var searchable = $('#addtagcoll_form #addtagcoll_searchable').prop('checked') ? 1 : 0;\n                                if (String(name).length > 0) {\n                                    window.location.href = href + \"&name=\" + encodeURIComponent(name) + \"&searchable=\" + searchable;\n                                }\n                                return false;\n                            });\n                        });\n                    }\n                );\n\n            });\n\n            $('body').on('click', '.tag-collections-table .action_delete', function(e) {\n                e.preventDefault();\n                var href = $(this).attr('data-url') + '&sesskey=' + M.cfg.sesskey;\n                str.get_strings([\n                        {key: 'delete'},\n                        {key: 'suredeletecoll', component: 'tag', param: $(this).attr('data-collname')},\n                        {key: 'yes'},\n                        {key: 'no'},\n                    ]).done(function(s) {\n                        notification.confirm(s[0], s[1], s[2], s[3], function() {\n                            window.location.href = href;\n                        });\n                    }\n                );\n            });\n        }\n    };\n});\n"]}