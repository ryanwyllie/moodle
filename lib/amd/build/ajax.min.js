define("core/ajax",["jquery","core/config","core/log","core/url"],function(a,b,c,d){var e=!1,f=function(a){var b=this,c=null,e=0,f,g;if(a.error){for(;e<b.length;e++){f=b[e];f.deferred.reject(a)}return}for(e=0;e<b.length;e++){f=b[e];g=a[e];if("undefined"!=typeof g){if(!1===g.error){f.deferred.resolve(g.data)}else{c=g.exception;break}}else{c=new Error("missing response");break}}if(null!==c){if("servicerequireslogin"===c.errorcode){window.location=d.relativeUrl("/login/index.php")}else{b.forEach(function(a){a.deferred.reject(c)})}}},g=function(a,b,d){var f=this,g=0;for(g=0;g<f.length;g++){var h=f[g];if(e){c.error("Page unloaded.");c.error(d)}else{h.deferred.reject(d)}}};return{call:function call(c,d,h){a(window).bind("beforeunload",function(){e=!0});var j=[],k,l=[],m=[],n="";if("undefined"==typeof h){h=!0}if("undefined"==typeof d){d=!0}for(k=0;k<c.length;k++){var o=c[k];j.push({index:k,methodname:o.methodname,args:o.args});o.deferred=a.Deferred();l.push(o.deferred.promise());if("undefined"!=typeof o.done){o.deferred.done(o.done)}if("undefined"!=typeof o.fail){o.deferred.fail(o.fail)}o.index=k;m.push(o.methodname)}if(5>=m.length){n=m.sort().join()}else{n=m.length+"-method-calls"}j=JSON.stringify(j);var p={type:"POST",data:j,context:c,dataType:"json",processData:!1,async:d,contentType:"application/json"},q="service.php";if(!h){q="service-nologin.php"}var r=b.wwwroot+"/lib/ajax/"+q+"?sesskey="+b.sesskey+"&info="+n;if(d){a.ajax(r,p).done(f).fail(g)}else{p.success=f;p.error=g;a.ajax(r,p)}return l}}});
//# sourceMappingURL=ajax.min.js.map
