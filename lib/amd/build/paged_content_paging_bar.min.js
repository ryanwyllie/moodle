define(["jquery","core/custom_interaction_events","core/paged_content_events","core/str"],function(a,b,c,d){var e={ROOT:'[data-region="paging-bar"]',PAGE:"[data-page]",PAGE_ITEM:'[data-region="page-item"]',PAGE_LINK:'[data-region="page-link"]',FIRST_BUTTON:'[data-control="first"]',LAST_BUTTON:'[data-control="last"]',NEXT_BUTTON:'[data-control="next"]',PREVIOUS_BUTTON:'[data-control="previous"]'},f=function(a,b){return a.find(e.PAGE_ITEM+'[data-page-number="'+b+'"]')},g=function(a){return a.find(e.NEXT_BUTTON)},h=function(a,b){a.attr("data-last-page-number",b)},i=function(a){return parseInt(a.attr("data-last-page-number"),10)},j=function(a){return parseInt(a.attr("data-active-page-number"),10)},k=function(a,b){a.attr("data-active-page-number",b)},l=function(a){var b=j(a);return!isNaN(b)&&0!=b},m=function(a,b){if(void 0!=b.attr("data-page"))return parseInt(b.attr("data-page-number"),10);var c=1,d=null;switch(b.attr("data-control")){case"first":c=1;break;case"last":c=i(a);break;case"next":d=j(a);var e=i(a);c=e?d&&d<e?d+1:e:d+1;break;case"previous":d=j(a),c=d&&d>1?d-1:1;break;default:c=1}return parseInt(c,10)},n=function(a){return parseInt(a.attr("data-items-per-page"),10)},o=function(a,b){a.attr("data-items-per-page",b)},p=function(a){a.removeClass("hidden")},q=function(a){a.addClass("hidden")},r=function(a){var b=a.find(e.NEXT_BUTTON),c=a.find(e.LAST_BUTTON);b.addClass("disabled"),b.attr("aria-disabled",!0),c.addClass("disabled"),c.attr("aria-disabled",!0)},s=function(a){var b=a.find(e.NEXT_BUTTON),c=a.find(e.LAST_BUTTON);b.removeClass("disabled"),b.removeAttr("aria-disabled"),c.removeClass("disabled"),c.removeAttr("aria-disabled")},t=function(a){var b=a.find(e.PREVIOUS_BUTTON),c=a.find(e.FIRST_BUTTON);b.addClass("disabled"),b.attr("aria-disabled",!0),c.addClass("disabled"),c.attr("aria-disabled",!0)},u=function(a){var b=a.find(e.PREVIOUS_BUTTON),c=a.find(e.FIRST_BUTTON);b.removeClass("disabled"),b.removeAttr("aria-disabled"),c.removeClass("disabled"),c.removeAttr("aria-disabled")},v=function(a){var b=a.attr("data-aria-label-components-pagination-item"),c=b.split(",").map(function(a){return a.trim()});return c},w=function(a){var b=a.attr("data-aria-label-components-pagination-active-item"),c=b.split(",").map(function(a){return a.trim()});return c},x=function(b,c){var d=0;k(b,0),c.each(function(c,e){var f=c+1;e=a(e),e.attr("data-page-number",f),d++,e.hasClass("active")&&k(b,f)}),h(b,d)},y=function(b){var c=v(b),f=w(b),g=j(b),h=b.find(e.PAGE_ITEM),i=h.map(function(d,e){e=a(e);var h=m(b,e);return h===g?{key:f[0],component:f[1],param:h}:{key:c[0],component:c[1],param:h}});d.get_strings(i).then(function(b){return h.each(function(c,d){d=a(d);var f=b[c];d.attr("aria-label",f),d.find(e.PAGE_LINK).attr("aria-label",f)}),b})["catch"](function(){})},z=function(a,b,d){var g=i(a),h=b==j(a),l=n(a),m=(b-1)*l;if(!h){a.find(e.PAGE_ITEM).removeClass("active").removeAttr("aria-current");var o=f(a,b);o.addClass("active"),o.attr("aria-current",!0),k(a,b)}g&&b>=g?r(a):s(a),b>1?u(a):t(a),y(a),d.publish(c.SHOW_PAGES,[{pageNumber:b,limit:l,offset:m}])},A=function(d,f){var g=d.attr("data-ignore-control-while-loading"),j=!1;""==g&&(g=!0),b.define(d,[b.events.activate]),d.on(b.events.activate,e.PAGE_ITEM,function(b,c){if(c.originalEvent.preventDefault(),c.originalEvent.stopPropagation(),!g||!j){var h=a(b.target).closest(e.PAGE_ITEM);if(!h.hasClass("disabled")){var i=m(d,h);z(d,i,f),j=!0}}}),f.subscribe(c.ALL_ITEMS_LOADED,function(a){j=!1;var b=i(d);(!b||a<b)&&h(d,a),1===a&&d.attr("data-hide-control-on-single-page")?(q(d),r(d),t(d)):(p(d),r(d))}),f.subscribe(c.PAGES_SHOWN,function(){j=!1}),f.subscribe(c.SET_ITEMS_PER_PAGE_LIMIT,function(a){o(d,a),h(d,0),k(d,0),p(d),z(d,1,f)})},B=function(b,c){b=a(b);var d=b.find(e.PAGE);if(x(b,d),A(b,c),l(b)){var h=j(b);f(b,h).click(),1==h&&t(b)}else g(b).click()};return{init:B,showPage:z,rootSelector:e.ROOT}});