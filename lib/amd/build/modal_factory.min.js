'use strict';define('core/modal_factory',['jquery','core/modal_events','core/modal_registry','core/modal','core/modal_save_cancel','core/modal_confirm','core/modal_cancel','core/templates','core/notification','core/custom_interaction_events'],function($,ModalEvents,ModalRegistry,Modal,ModalSaveCancel,ModalConfirm,ModalCancel,Templates,Notification,CustomEvents){var TEMPLATES={DEFAULT:'core/modal',SAVE_CANCEL:'core/modal_save_cancel',CONFIRM:'core/modal_save_cancel',CANCEL:'core/modal_cancel'},TYPES={DEFAULT:'DEFAULT',SAVE_CANCEL:'SAVE_CANCEL',CONFIRM:'CONFIRM',CANCEL:'CANCEL'};ModalRegistry.register(TYPES.DEFAULT,Modal,TEMPLATES.DEFAULT),ModalRegistry.register(TYPES.SAVE_CANCEL,ModalSaveCancel,TEMPLATES.SAVE_CANCEL),ModalRegistry.register(TYPES.CONFIRM,ModalConfirm,TEMPLATES.CONFIRM),ModalRegistry.register(TYPES.CANCEL,ModalCancel,TEMPLATES.CANCEL);var setUpTrigger=function(modalPromise,triggerElement,modalConfig){var actualTriggerElement=null,hasPreShowCallback='function'==typeof modalConfig.preShowCallback,triggeredCallback=function(e,data){actualTriggerElement=$(e.currentTarget),modalPromise.then(function(modal){return hasPreShowCallback&&modalConfig.preShowCallback(actualTriggerElement,modal),modal.show(),modal}),data.originalEvent.preventDefault()};if(Array.isArray(triggerElement)){var selector=triggerElement[1];triggerElement=triggerElement[0],CustomEvents.define(triggerElement,[CustomEvents.events.activate]),triggerElement.on(CustomEvents.events.activate,selector,triggeredCallback)}else CustomEvents.define(triggerElement,[CustomEvents.events.activate]),triggerElement.on(CustomEvents.events.activate,triggeredCallback);modalPromise.then(function(modal){return modal.getRoot().on(ModalEvents.hidden,function(){null!==actualTriggerElement&&actualTriggerElement.focus()}),modal})},createFromElement=function(registryConf,modalElement){modalElement=$(modalElement);var module=registryConf.module,modal=new module(modalElement);return modal},createFromType=function(registryConf,templateContext){var templateName=registryConf.template,modalPromise=Templates.render(templateName,templateContext).then(function(html){var modalElement=$(html);return createFromElement(registryConf,modalElement)}).fail(Notification.exception);return modalPromise};return{create:function create(modalConfig,triggerElement){var type=modalConfig.type||TYPES.DEFAULT,isLarge=!!modalConfig.large,registryConf=null,templateContext={};registryConf=ModalRegistry.get(type),registryConf||Notification.exception({message:'Unable to find modal of type: '+type}),'undefined'!=typeof modalConfig.templateContext&&(templateContext=modalConfig.templateContext);var modalPromise=createFromType(registryConf,templateContext).then(function(modal){return'undefined'!=typeof modalConfig.title&&modal.setTitle(modalConfig.title),'undefined'!=typeof modalConfig.body&&modal.setBody(modalConfig.body),'undefined'!=typeof modalConfig.footer&&modal.setFooter(modalConfig.footer),isLarge&&modal.setLarge(),modal});return'undefined'!=typeof triggerElement&&setUpTrigger(modalPromise,triggerElement,modalConfig),modalPromise},types:TYPES}});
//# sourceMappingURL=modal_factory.min.js.map
