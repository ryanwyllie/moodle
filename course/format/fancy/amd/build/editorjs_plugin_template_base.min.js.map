{"version":3,"sources":["../src/editorjs_plugin_template_base.js"],"names":["TemplateBase","data","config","template","wrapper","tree","window","console","log","observable","document","createElement","VDOMVirtualise","virtualise","renderFromTemplate","bind","registerEventListeners","html","Templates","syncRender","newTree","VirtualHTML","virtualHTML","patches","VirtualDOM","diff","patch","toJS"],"mappings":"iQAsBA,OACA,OACA,OACA,O,uXAGqBA,CAAAA,C,YACjB,aAA8B,IAAhBC,CAAAA,CAAgB,GAAhBA,IAAgB,CAAVC,CAAU,GAAVA,MAAU,WAC1B,KAAKD,IAAL,CAAYA,CAAZ,CACA,KAAKE,QAAL,CAAgBD,CAAM,CAACC,QAAvB,CACA,KAAKC,OAAL,CAAe,IAAf,CACA,KAAKC,IAAL,CAAY,IACf,C,0EAEwB,CAExB,C,uCAEQ,CACLC,MAAM,CAACC,OAAP,CAAeC,GAAf,CAAmB,YAAnB,CAAiCC,YAAjC,EACA,KAAKR,IAAL,CAAY,iBAAW,KAAKA,IAAhB,CAAZ,CACA,KAAKG,OAAL,CAAeM,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAf,CACA,KAAKN,IAAL,CAAYO,UAAeC,UAAf,CAA0B,KAAKT,OAA/B,CAAZ,CACA,cAAQ,KAAKU,kBAAL,CAAwBC,IAAxB,CAA6B,IAA7B,CAAR,EACA,KAAKC,sBAAL,CAA4B,KAAKZ,OAAjC,CAA0C,KAAKH,IAA/C,EAEA,MAAO,MAAKG,OACf,C,+DAEoB,IACXa,CAAAA,CAAI,CAAGC,UAAUC,UAAV,CAAqB,KAAKhB,QAA1B,CAAoC,KAAKF,IAAzC,CADI,CAGXmB,CAAO,CAAGC,UAAYC,WAAZ,gBAAgCL,CAAhC,WAHC,CAIXM,CAAO,CAAGC,UAAWC,IAAX,CAAgB,KAAKpB,IAArB,CAA2Be,CAA3B,CAJC,CAKjBI,UAAWE,KAAX,CAAiB,KAAKtB,OAAtB,CAA+BmB,CAA/B,EACA,KAAKlB,IAAL,CAAYe,CACf,C,mCAEM,CACH,MAAO,MAAKnB,IAAL,CAAU0B,IAAV,EACV,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * EditorJS plugin base for using template to render.\n *\n * @copyright  2019 Ryan Wyllie <ryan@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport VirtualHTML from 'core/virtual-html';\nimport VirtualDOM from 'core/virtual-dom';\nimport VDOMVirtualise from 'core/vdom-virtualise';\nimport Templates from 'core/templates';\nimport { observable, autorun } from 'core/mobx';\n\nexport default class TemplateBase {\n    constructor({ data, config }) {\n        this.data = data;\n        this.template = config.template;\n        this.wrapper = null;\n        this.tree = null;\n    }\n\n    registerEventListeners() {\n        // Override me.\n    }\n\n    render() {\n        window.console.log(\"Observable\", observable);\n        this.data = observable(this.data);\n        this.wrapper = document.createElement('div');\n        this.tree = VDOMVirtualise.virtualise(this.wrapper);\n        autorun(this.renderFromTemplate.bind(this));\n        this.registerEventListeners(this.wrapper, this.data);\n\n        return this.wrapper;\n    }\n\n    renderFromTemplate() {\n        const html = Templates.syncRender(this.template, this.data);\n        // Add our wrapping div so that we don't replace the root node.\n        const newTree = VirtualHTML.virtualHTML(`<div>${html}</div>`);\n        const patches = VirtualDOM.diff(this.tree, newTree);\n        VirtualDOM.patch(this.wrapper, patches);\n        this.tree = newTree;\n    }\n\n    save() {\n        return this.data.toJS();\n    }\n}"],"file":"editorjs_plugin_template_base.min.js"}