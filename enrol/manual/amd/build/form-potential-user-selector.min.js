'use strict';define('enrol_manual/form-potential-user-selector',['jquery','core/ajax','core/templates','core/str'],function($,Ajax,Templates,Str){return{processResults:function processResults(selector,results){var users=[];return $.isArray(results)?($.each(results,function(index,user){users.push({value:user.id,label:user._label})}),users):results},transport:function transport(selector,query,success,failure){var promise,courseid=$(selector).attr('courseid');'undefined'==typeof courseid&&(courseid='1');var enrolid=$(selector).attr('enrolid');'undefined'==typeof enrolid&&(enrolid=''),promise=Ajax.call([{methodname:'core_enrol_get_potential_users',args:{courseid:courseid,enrolid:enrolid,search:query,searchanywhere:!0,page:0,perpage:101}}]),promise[0].then(function(results){var promises=[],i=0;return 100>=results.length?($.each(results,function(index,user){var ctx=user,identity=[];$.each(['idnumber','email','phone1','phone2','department','institution'],function(i,k){'undefined'!=typeof user[k]&&''!==user[k]&&(ctx.hasidentity=!0,identity.push(user[k]))}),ctx.identity=identity.join(', '),promises.push(Templates.render('enrol_manual/form-user-selector-suggestion',ctx))}),$.when.apply($.when,promises).then(function(){var args=arguments;return $.each(results,function(index,user){user._label=args[i],i++}),void success(results)})):Str.get_string('toomanyuserstoshow','core','>100').then(function(toomanyuserstoshow){success(toomanyuserstoshow)})}).fail(failure)}}});
//# sourceMappingURL=form-potential-user-selector.min.js.map
