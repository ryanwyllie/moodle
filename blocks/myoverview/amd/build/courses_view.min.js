define(["jquery","core/templates","block_myoverview/courses_view_repository","core/notification"],function(a,b,c,d){var e={COURSES_IN_PROGRESS_CONTAINER:'[data-region="courses-in-progress-container"]',LOADING_ICON_CONTAINER:'[data-region="loading-icon-container"]'},f=function(a){a.attr("data-loaded-all",!0)},g=function(a){var b=a.find(e.LOADING_ICON_CONTAINER);a.addClass("loading"),b.removeClass("hidden")},h=function(a){var b=a.find(e.LOADING_ICON_CONTAINER);a.removeClass("loading"),b.addClass("hidden")},i=function(a){return a.hasClass("loading")},j=function(b,e){b=a(b);var j=+b.attr("data-limit"),m=+b.attr("data-offset"),n=b.attr("data-status"),o=c.getTotalByStatus("past");return i(b)?a.Deferred().resolve():(g(b),c.queryFromStatus(n,j,m).then(function(a){(!a.length||a.length<j)&&f(b),a.length&&(b.attr("data-offset",m+a.length),l(b,a),f(b))}).fail(d.exception).always(function(){h(b),k(e,j,o)}))},k=function(c,d,e){c=a(c),c.empty();var f,g=e/d,h={haspages:e>0,previous:{},pages:[],next:{}};for(f=0;f<g;f++)h.pages.push({page:f+1});return b.render("core/paging_bar",h).done(function(a,d){b.appendNodeContents(c,a,d)})},l=function(c,d){c=a(c),c.empty(),a.each(d,function(a,d){b.render("block_myoverview/courses-view-course-item",d).done(function(a,d){b.appendNodeContents(c,a,d)})})},m=function(b,c){b=a(b),c=a(c);var d=(+b.attr("data-offset"),+b.attr("data-limit"));b.attr("data-status");c.on("click","a",function(e){e.preventDefault();var f=a(e.currentTarget),g=f[0].innerText,h=d*g/g;1==g&&(h=0),b.attr("data-offset",h),j(b,c)})};return{init:function(b,c){b=a(b),c=a(c),m(b,c),j(b,c)}}});