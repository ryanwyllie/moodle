'use strict';define('block_online_users/change_user_visibility',['jquery','core/ajax','core/str','core/notification'],function($,Ajax,Str,Notification){var SELECTORS={CHANGE_VISIBILITY_LINK:'#change-user-visibility',CHANGE_VISIBILITY_ICON:'#change-user-visibility .icon'},changeVisibility=function(action,userid){var value='show'==action?1:0;Ajax.call([{methodname:'core_user_set_user_preferences',args:{preferences:[{name:'block_online_users_uservisibility',value:value,userid:userid}]}}])[0].then(function(data){if(data.saved){var newAction=oppositeAction(action);changeVisibilityLinkAttr(newAction),changeVisibilityIconAttr(newAction)}}).catch(Notification.exception)},oppositeAction=function(action){return'show'==action?'hide':'show'},changeVisibilityLinkAttr=function(action){getTitle(action).then(function(title){$(SELECTORS.CHANGE_VISIBILITY_LINK).attr({"data-action":action,title:title})}).catch(Notification.exception)},changeVisibilityIconAttr=function(action){var icon=$(SELECTORS.CHANGE_VISIBILITY_ICON);getTitle(action).then(function(title){return $(icon).attr({title:title,"aria-label":title}),void(icon.is('img')?$(icon).attr({src:M.util.image_url('t/'+action),alt:title}):($(icon).addClass(getIconClass(action)),$(icon).removeClass(getIconClass(oppositeAction(action)))))}).catch(Notification.exception)},getIconClass=function(action){return'show'==action?'fa-eye-slash':'fa-eye'},getTitle=function(action){return Str.get_string('online_status:'+action,'block_online_users')};return{init:function init(){$(SELECTORS.CHANGE_VISIBILITY_LINK).on('click',function(e){e.preventDefault();var action=$(this).attr('data-action'),userid=$(this).attr('data-userid');changeVisibility(action,userid)})}}});
//# sourceMappingURL=change_user_visibility.min.js.map
